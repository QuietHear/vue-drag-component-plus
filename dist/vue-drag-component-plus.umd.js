(function(e,R){typeof exports=="object"&&typeof module<"u"?module.exports=R(require("vue")):typeof define=="function"&&define.amd?define(["vue"],R):(e=typeof globalThis<"u"?globalThis:e||self,e.vueDragComponentPlus=R(e.Vue))})(this,function(e){"use strict";const R={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(E){return(T,se)=>{const _=e.resolveComponent("el-icon");return E.iconObj.type==="custom"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(E.iconObj.icon),e.normalizeProps(e.mergeProps({key:0},E.iconObj.attrs)),null,16)):E.iconObj.type==="el"?(e.openBlock(),e.createBlock(_,e.normalizeProps(e.mergeProps({key:1},E.iconObj.attrs)),{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(E.iconObj.icon)))]),_:1},16)):E.iconObj.type==="iconfont"?(e.openBlock(),e.createElementBlock("i",e.mergeProps({key:2,class:["icon iconfont","icon-"+E.iconObj.icon]},E.iconObj.attrs),null,16)):(e.openBlock(),e.createElementBlock("i",e.mergeProps({key:3,class:E.iconObj.type},E.iconObj.attrs),e.toDisplayString(E.iconObj.icon),17))}}},Je="",me=["onMousedown"],Be={class:"com-item-content"},ve=["title"],Ce=["onClick"],De=["onClick"],Oe=["onClick"],Ve=["onClick"],Se=["onClick"],ze=["onClick"],Ne=["onClick"],Ge=["onMousedown"],He=["onMousedown"],We=["onMousedown"],Pe=["onMousedown"],Te=["onMousedown"],Ie=["onMousedown"],Ye=["onMousedown"],Xe=["onMousedown"],be={key:1,class:"com-empty"},Re=[{__name:"index",props:{insertResizeKeys:{type:Array,default:()=>["topLeft","top","topRight","left","right","bottomLeft","bottom","bottomRight"]},excludeResizeKeys:{type:Array,default:()=>[]},seeModel:{type:Boolean,default:!1},itemMinWidth:{type:Number,default:15,validator(E,T){return E>=15}},itemMinHeight:{type:Number,default:15,validator(E,T){return E>=15}},ySpace:{type:Number,default:7,validator(E,T){return E>=0}},settingIcon:{type:Object,default:()=>({icon:"设置"})},hideTit:{type:Boolean,default:!1}},emits:["showGroup","updateChecked","showTitPop"],setup(E,{expose:T,emit:se}){const _=se,k=E,O=o=>{let r=o instanceof Array?[]:{};for(let t in o)r[t]=typeof o[t]=="object"?O(o[t]):o[t];return r},ae=()=>{k.insertResizeKeys.forEach(o=>{k.excludeResizeKeys.indexOf(o)===-1&&G.value.push(o)})};e.watch(()=>[k.insertResizeKeys,k.excludeResizeKeys],()=>{ae()});const G=e.ref([]);ae();const z=e.ref(null);let H=null,q=null;const K=e.ref(null),U=e.ref(0),a=e.ref([]),_e=(o,r)=>{let t=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector;for(;o&&!t.call(o,r);)o=o.parentElement;return o};let m=null,ce=null,he=null;const C=e.ref({}),$e=(o,r)=>{F(),m=r,C.value=O(a.value[m]),a.value[m].move=!0;const t=_e(o.target,".com-item");ce=o.clientX-t.offsetLeft,he=o.clientY-t.offsetTop,window.addEventListener("mousemove",de),window.addEventListener("mouseup",pe)},de=o=>{const r=o.clientX-ce,t=o.clientY-he,n=r<=W("left")?W("left"):r>=W("right")?W("right"):r,l=t<=W("top")?W("top"):t>=W("bottom")?W("bottom"):t,x=n-a.value[m].x,f=l-a.value[m].y,M=`${x>0?"right":x<0?"left":""}_${f>0?"bottom":f<0?"top":""}`;l>a.value[m].y&&l>q-a.value[m].height-30&&K.value.scrollBy(0,20),l<a.value[m].y&&l-K.value.scrollTop<30&&K.value.scrollBy(0,-20),a.value[m].x=n,a.value[m].y=l;let y=O(a.value.filter(p=>p.move!==!0).filter(p=>p.x<n&&p.x+p.width>n||p.x===n||p.x>n&&p.x<n+a.value[m].width).filter(p=>p.y<l&&p.y+p.height>l||p.y===l||p.y>l&&p.y<l+a.value[m].height));if(y.length===0)C.value.x=n,C.value.y=l;else{if(M.indexOf("top")!==-1){y=y.filter(h=>h.y<C.value.y);const p=Math.min(...y.map(h=>h.y+h.height));y.forEach(h=>{Math.abs(h.y+h.height-p)<5&&(h.y=p-h.height)});let c=C.value.y-l,i=!0,s=[...y];const d=h=>{O(a.value.filter(g=>g.move!==!0&&g.y+g.height-h.y<=c+3&&g.y+g.height-h.y>=0).filter(g=>g.x<h.x&&g.x+g.width>h.x||g.x>=h.x&&g.x<h.x+h.width)).forEach(g=>{g.y+g.height!==h.y&&(g.y=h.y-g.height),s.findIndex(v=>v.id===g.id)===-1&&(s.push(g),d(g))})};if(y.forEach(h=>{d(h)}),s.sort((h,w)=>{const g=h.y,v=w.y;return g-v}),(s.length===0||s.filter(h=>h.y===0).length>0)&&(i=!1),i){let h=0;s.filter(g=>g.y===s[0].y).forEach(g=>{O(a.value.filter(V=>V.move!==!0&&V.y+V.height<g.y).filter(V=>V.x<g.x&&V.x+V.width>g.x||V.x>=g.x&&V.x<g.x+g.width)).forEach(V=>{V.y+V.height>h&&(h=V.y+V.height)})}),h=s[0].y-h,h<c&&(c=h),s.forEach(g=>{g.y-=c,a.value.filter(v=>v.id===g.id)[0].y=g.y}),C.value.x=n,C.value.y=a.value.filter(g=>g.id===s[s.length-1].id)[0].y+a.value.filter(g=>g.id===s[s.length-1].id)[0].height}else{const h=Math.min(...y.map(w=>w.y));h-l>=-7&&h-l<7&&(y.filter(w=>w.y<C.value.y).forEach(w=>{w.y+=a.value[m].height,a.value.filter(v=>v.id===w.id)[0].y=w.y;const g=v=>{a.value.filter(D=>D.move!==!0&&D.id!==v.id).filter(D=>D.x<v.x&&D.x+D.width>v.x||D.x===v.x||D.x>v.x&&D.x<v.x+v.width).filter(D=>D.y<v.y&&D.y+D.height>v.y||D.y===v.y||D.y>v.y&&D.y<v.y+v.height).forEach(D=>{D.y=v.y+v.height,g(D)})};g(w)}),C.value.x=n,C.value.y=h)}y=O(a.value.filter(h=>h.move!==!0).filter(h=>h.x<n&&h.x+h.width>n||h.x===n||h.x>n&&h.x<n+a.value[m].width).filter(h=>h.y<l&&h.y+h.height>l||h.y===l||h.y>l&&h.y<l+a.value[m].height))}if(M.indexOf("bottom")!==-1){const p=Math.max(...y.map(c=>c.y+c.height));if(p-(l+a.value[m].height)>=-7&&p-(l+a.value[m].height)<7){let c=!0;y.filter(i=>i.y>C.value.y).forEach(i=>{i.y-=a.value[m].height,a.value.filter(d=>d.id===i.id)[0].y=i.y;const s=a.value.filter(d=>d.move!==!0&&d.id!==i.id).filter(d=>d.x<i.x&&d.x+d.width>i.x||d.x===i.x||d.x>i.x&&d.x<i.x+i.width).filter(d=>d.y<i.y&&d.y+d.height>i.y||d.y===i.y||d.y>i.y&&d.y<i.y+i.height);if(s.length>0){i.y=Math.max(...s.map(h=>h.y+h.height)),a.value.filter(h=>h.id===i.id)[0].y=i.y;const d=h=>{a.value.filter(g=>g.id!==h.id).filter(g=>g.x<h.x&&g.x+g.width>h.x||g.x===h.x||g.x>h.x&&g.x<h.x+h.width).filter(g=>g.y<h.y&&g.y+g.height>h.y||g.y===h.y||g.y>h.y&&g.y<h.y+h.height).forEach(g=>{g.y=h.y+h.height,g.move===!0&&(C.value.y=g.y,c=!1),d(g)})};d(i)}}),C.value.x=n,c&&(C.value.y=p-a.value[m].height),y=O(a.value.filter(i=>i.move!==!0).filter(i=>i.x<n&&i.x+i.width>n||i.x===n||i.x>n&&i.x<n+a.value[m].width).filter(i=>i.y<l&&i.y+i.height>l||i.y===l||i.y>l&&i.y<l+a.value[m].height))}}if(((M.indexOf("top")!==-1||M.indexOf("bottom")!==-1)&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1)&&Math.abs(x)>8||M.indexOf("top")===-1&&M.indexOf("bottom")===-1&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1))&&y.length>0){y.sort((c,i)=>{const s=c.y,d=i.y;return s-d});let p=!0;for(let c=0;c<y.length;c++){if(p){const i=O(a.value);for(let s=0;s<=c;s++){let d=null;const h=i.filter(w=>w.move!==!0&&w.y<y[s].y).filter(w=>w.x<y[s].x&&w.x+w.width>y[s].x||w.x===y[s].x||w.x>y[s].x&&w.x<y[s].x+y[s].width);if(h.length===0?d=0:d=Math.max(...h.map(w=>w.y+w.height)),s===c){if(y[s].y-(y[s].y+y[s].height-l)<d){p=!1;break}}else if(y[s].y-y[c].height<d){p=!1;break}else i.filter(w=>w.id===y[s].id)[0].y-=y[c].height}}if(p){y[c].y-=y[c].y+y[c].height-l,a.value.filter(i=>i.id===y[c].id)[0].y=y[c].y;for(let i=c;i>0;i--)y[c-1].y-=y[c].height,a.value.filter(s=>s.id===y[c-1].id)[0].y=y[c-1].y}else y.filter(i=>i.id===y[c].id).forEach(i=>{i.y+=a.value[m].y+a.value[m].height-i.y,a.value.filter(d=>d.id===i.id)[0].y=i.y;const s=d=>{a.value.filter(w=>w.move!==!0&&w.id!==d.id).filter(w=>w.x<d.x&&w.x+w.width>d.x||w.x===d.x||w.x>d.x&&w.x<d.x+d.width).filter(w=>w.y<d.y&&w.y+w.height>d.y||w.y===d.y||w.y>d.y&&w.y<d.y+d.height).forEach(w=>{w.y=d.y+d.height,s(w)})};s(i)})}C.value.x=n}}S(!1)},pe=()=>{window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",pe),delete a.value[m].move,a.value[m].x=C.value.x,a.value[m].y=C.value.y,m=null,S()},W=o=>{switch(o){case"top":return 0;case"right":return H-a.value[m].width;case"bottom":return 999999999;case"left":return 0}};let u=null,le="",J=0,Q=0,I=0,Y=0,X=0,b=0,$=0,Z=0,L=0,j=0;const P=(o,r,t)=>{F(),u=r,le=t,J=o.clientX,Q=o.clientY,I=r.width,Y=r.height,X=r.y,b=r.x,u.drag=!0;const n=a.value.filter(p=>p.static===!0&&(p.x<r.x?p.x+p.width>=r.x:p.x<=r.x+r.width)),l=a.value.filter(p=>p.static===!0&&(p.y<r.y?p.y+p.height>=r.y:p.y<=r.y+r.height)),x=n.filter(p=>p.y+p.height<=r.y).map(p=>p.y+p.height);x.length>0?$=Math.max(...x):$=0;const f=n.filter(p=>p.y>=r.y+r.height).map(p=>p.y);f.length>0?Z=Math.min(...f):Z=0;const M=l.filter(p=>p.x+p.width<=r.x).map(p=>p.x+p.width);M.length>0?L=Math.max(...M):L=0;const y=l.filter(p=>p.x>=r.x+r.width).map(p=>p.x);y.length>0?j=Math.min(...y):j=0,window.addEventListener("mousemove",ge),window.addEventListener("mouseup",fe)},ge=o=>{const r=I+(o.clientX-J),t=Y+(o.clientY-Q),n=I-(o.clientX-J),l=Y-(o.clientY-Q),x=X+(o.clientY-Q),f=b+(o.clientX-J),M=getComputedStyle(z.value),y=parseInt(M.getPropertyValue("--com-item-border-width").trim()),p=parseInt(M.getPropertyValue("--group-tit-height").trim());switch(le){case"top-left":if(u.height=l<k.itemMinHeight?k.itemMinHeight:l>B("top")?B("top"):l,u.y=l<k.itemMinHeight?X+Y-k.itemMinHeight:l>B("top")?$:x,u.width=n<k.itemMinWidth?k.itemMinWidth:n>B("left")?B("left"):n,u.x=n<k.itemMinWidth?b+I-k.itemMinWidth:n>B("left")?L:f,u.isGroup===!0){const i=u.width-2*y,s=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(d=>{d.width=i*d.groupW,d.x=i*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"top":if(u.height=l<k.itemMinHeight?k.itemMinHeight:l>B("top")?B("top"):l,u.y=l<k.itemMinHeight?X+Y-k.itemMinHeight:l>B("top")?$:x,u.isGroup===!0){const i=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.height=i*s.groupH,s.y=i*s.groupY})}break;case"top-right":if(u.height=l<k.itemMinHeight?k.itemMinHeight:l>B("top")?B("top"):l,u.y=l<k.itemMinHeight?X+Y-k.itemMinHeight:l>B("top")?$:x,u.width=r<k.itemMinWidth?k.itemMinWidth:r>B("right")?B("right"):r,u.isGroup===!0){const i=u.width-2*y,s=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(d=>{d.width=i*d.groupW,d.x=i*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"left":if(u.width=n<k.itemMinWidth?k.itemMinWidth:n>B("left")?B("left"):n,u.x=n<k.itemMinWidth?b+I-k.itemMinWidth:n>B("left")?L:f,u.isGroup===!0){const i=u.width-2*y;u.groupData.forEach(s=>{s.width=i*s.groupW,s.x=i*s.groupX})}break;case"right":if(u.width=r<k.itemMinWidth?k.itemMinWidth:r>B("right")?B("right"):r,u.isGroup===!0){const i=u.width-2*y;u.groupData.forEach(s=>{s.width=i*s.groupW,s.x=i*s.groupX})}break;case"bottom-left":if(u.height=t<k.itemMinHeight?k.itemMinHeight:t>B("bottom")?B("bottom"):t,u.width=n<k.itemMinWidth?k.itemMinWidth:n>B("left")?B("left"):n,u.x=n<k.itemMinWidth?b+I-k.itemMinWidth:n>B("left")?L:f,u.isGroup===!0){const i=u.width-2*y,s=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(d=>{d.width=i*d.groupW,d.x=i*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"bottom":if(u.height=t<k.itemMinHeight?k.itemMinHeight:t>B("bottom")?B("bottom"):t,u.isGroup===!0){const i=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.height=i*s.groupH,s.y=i*s.groupY})}break;case"bottom-right":if(u.height=t<k.itemMinHeight?k.itemMinHeight:t>B("bottom")?B("bottom"):t,u.width=r<k.itemMinWidth?k.itemMinWidth:r>B("right")?B("right"):r,u.isGroup===!0){const i=u.width-2*y,s=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(d=>{d.width=i*d.groupW,d.x=i*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break}let c=O(a.value.filter(i=>i.drag!==!0).filter(i=>i.x<u.x&&i.x+i.width>u.x||i.x===u.x||i.x>u.x&&i.x<u.x+u.width).filter(i=>i.y<u.y&&i.y+i.height>u.y||i.y===u.y||i.y>u.y&&i.y<u.y+u.height));if(c.length>0){c.sort((i,s)=>{const d=i.y,h=s.y;return d-h});for(let i=0;i<c.length;i++)c.filter(s=>s.id===c[i].id).forEach(s=>{s.y+=u.y+u.height-s.y,a.value.filter(h=>h.id===s.id)[0].y=s.y;const d=h=>{a.value.filter(g=>g.drag!==!0&&g.id!==h.id).filter(g=>g.x<h.x&&g.x+g.width>h.x||g.x===h.x||g.x>h.x&&g.x<h.x+h.width).filter(g=>g.y<h.y&&g.y+g.height>h.y||g.y===h.y||g.y>h.y&&g.y<h.y+h.height).forEach(g=>{g.y=h.y+h.height,d(g)})};d(s)})}S(!1),K.value.scrollTo(0,U.value-q)},fe=o=>{delete u.drag,le="",u=null,window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",fe),S()},B=o=>{switch(o){case"top":return X+Y-$;case"left":return b+I-L;case"right":return(j>0?j:H)-b;case"bottom":return Z>0?Z-X:999999999}},S=(o=!0)=>{o===!0&&ue();const r=a.value.map(t=>t.y+t.height);r.length>0?U.value=Math.max(...r)+50:U.value=0};e.watch(()=>k.ySpace,()=>{k.ySpace>=0&&ue()});const ue=()=>{a.value.sort((o,r)=>{const t=o.y,n=r.y;return t-n});for(let o=0;o<a.value.length-1;o++){if(o===0&&a.value[o].y>0){const r=a.value[o].y;for(let t=o;t<a.value.length;t++)a.value[t].y-=r}if(a.value[o+1].y>a.value[o].y+a.value[o].height){const r=a.value[o+1].y-(a.value[o].y+a.value[o].height);for(let t=o+1;t<a.value.length;t++)a.value[t].y-=r}}for(let o=0;o<a.value.length-1;o++){let r=a.value.findIndex(t=>t.y===a.value[o].y+a.value[o].height);if(r!==-1)for(let t=r;t<a.value.length;t++)a.value[t].y+=k.ySpace}};e.onMounted(()=>{ye.observe(z.value)});const ye=new ResizeObserver(o=>{Ae(H===o[0].contentRect.width?null:o[0].contentRect.width,q===o[0].contentRect.height?null:o[0].contentRect.height)});let oe=!1;const Le=(o=[],r=null)=>{a.value=O(o),r!==null?e.nextTick(()=>{const n=z.value.getBoundingClientRect().width/r,l=getComputedStyle(z.value),x=parseInt(l.getPropertyValue("--com-item-border-width").trim()),f=parseInt(l.getPropertyValue("--group-tit-height").trim());a.value.forEach(M=>{if(M.width*=n,M.height*=n,M.x*=n,M.y*=n,M.isGroup===!0){const y=M.width-2*x,p=M.height-2*x-(M.groupTit?f:0);M.groupData.forEach(c=>{c.width=y*c.groupW,c.x=y*c.groupX,c.height=p*c.groupH,c.y=p*c.groupY})}}),S()}):S(),oe=!0,setTimeout(()=>{oe=!1},500)},xe=(o,r,t)=>{const n=r.map(f=>f.y),l=Math.max(...n),x=r.filter(f=>f.y+f.height>l);x.sort((f,M)=>{const y=f.x,p=M.x;return y-p});for(let f=0;f<x.length;f++){if(f===0&&x[f].x>=o.width){o.y=l,o.x=0;break}if(x.length>1&&f!==x.length-1&&x[f].x+x[f].width+o.width<=x[f+1].x){o.y=l,o.x=x[f].x+x[f].width;break}if(f===x.length-1&&x[f].x+x[f].width+o.width<=t){o.y=l,o.x=x[f].x+x[f].width;break}}if(o.y==null){o.x=0;const f=r.map(M=>M.y+M.height);o.y=Math.max(...f)}},ee=(o,r=null,t=!1)=>{const n=O(o),l=a.value.filter(x=>x.id===r);if(n.id||(n.id=new Date().getTime()+""),r&&l.length!==1){try{}catch{}return}if(t!==!0)if(delete n.x,delete n.y,r){const x=getComputedStyle(z.value),f=parseInt(x.getPropertyValue("--com-item-border-width").trim());xe(n,l[0].groupData,l[0].width-2*f)}else a.value.length===0?(n.x=0,n.y=0):xe(n,a.value,H);if(r){l[0].groupData.push(n);const x=ie(l[0].groupData,l[0]);re(x)}else a.value.push(n);S()},A=(o,r=null)=>{let t=-1;const n=a.value.filter(l=>l.id===r);if(r?n.length===1&&(t=n[0].groupData.findIndex(l=>l.id===o)):t=a.value.findIndex(l=>l.id===o),t!==-1){if(r)if(n[0].groupData.splice(t,1),n[0].groupData.length===1)te(r);else{const l=ie(n[0].groupData,n[0]);re(l)}else a.value.splice(t,1);S()}else try{}catch{}},re=o=>{if(o.id){const r=O(o);let t=-1;const n=a.value.filter(l=>l.id===r.inGroupId);if(r.inGroupId?n.length===1&&(t=n[0].groupData.findIndex(l=>l.id===r.id)):t=a.value.findIndex(l=>l.id===r.id),t!==-1)r.inGroupId?n[0].groupData[t]=r:a.value[t]=r,S();else try{}catch{}}else try{}catch{}},Ae=(o,r)=>{if(o!==null){const t=H?o/H:1;H=o;const n=getComputedStyle(z.value),l=parseInt(n.getPropertyValue("--com-item-border-width").trim()),x=parseInt(n.getPropertyValue("--group-tit-height").trim());oe||(a.value.forEach(f=>{if(f.width*=t,f.height*=t,f.x*=t,f.y*=t,f.isGroup===!0){const M=f.width-2*l,y=f.height-2*l-(f.groupTit?x:0);f.groupData.forEach(p=>{p.width=M*p.groupW,p.x=M*p.groupX,p.height=y*p.groupH,p.y=y*p.groupY})}}),S())}r!==null&&(q=r)},we=o=>{o.showPop||(a.value.forEach(r=>{delete r.showPop,r.groupData&&r.groupData.forEach(t=>{delete t.showPop})}),o.showPop=!0,window.addEventListener("click",F))},F=()=>{a.value.forEach(o=>{delete o.showPop,o.groupData&&o.groupData.forEach(r=>{delete r.showPop})}),window.removeEventListener("click",F)},N=e.ref(!1),ke=o=>{const r=a.value.findIndex(t=>t.id===o);if(r!==-1)a.value[r].checked=!0,a.value[r].disabled=!0,N.value=!0,_("showGroup",N.value);else try{}catch{}},Me=()=>{N.value=!1,a.value.forEach(o=>{delete o.checked,delete o.disabled,o.groupData&&o.groupData.forEach(r=>{delete r.checked,delete r.disabled})}),_("showGroup",N.value)},Ke=o=>{o.checked=!o.checked,_("updateChecked",a.value.filter(r=>r.checked).length)},ie=(o,r)=>{const t=O(o),n=O(r);t.sort((c,i)=>{const s=c.x,d=i.x;return s-d});for(let c=0;c<t.length-1;c++){if(c===0&&t[c].x>0){const i=t[c].x;for(let s=c;s<t.length;s++)t[s].x-=i}if(t[c+1].x>t[c].x+t[c].width){const i=t[c+1].x-(t[c].x+t[c].width);for(let s=c+1;s<t.length;s++)t[s].x-=i}}t.sort((c,i)=>{const s=c.y,d=i.y;return s-d});for(let c=0;c<t.length-1;c++){if(c===0&&t[c].y>0){const i=t[c].y;for(let s=c;s<t.length;s++)t[s].y-=i}if(t[c+1].y>t[c].y+t[c].height){const i=t[c+1].y-(t[c].y+t[c].height);for(let s=c+1;s<t.length;s++)t[s].y-=i}}const l=t.map(c=>c.x+c.width),x=Math.max(...l),f=t.map(c=>c.y+c.height),M=Math.max(...f);t.forEach(c=>{c.inGroupId||(c.inGroupId=n.id),c.groupW=c.width/x,c.groupH=c.height/M,c.groupX=c.x/x,c.groupY=c.y/M,c.isObstacle=c.x+c.width===x&&c.y===0});const y=getComputedStyle(z.value),p=parseInt(y.getPropertyValue("--com-item-border-width").trim());return n.width=x+2*p,n.height=M+2*p,n.groupData=[...t],n},Fe=()=>{const o=a.value.filter(r=>r.checked);if(o.length>1){const r={id:new Date().getTime()+"G",isGroup:!0,groupTit:""},t=ie(o,r);t.groupData.forEach(n=>{A(n.id)}),ee(t),S()}Me()},Ee=(o,r)=>{const t=a.value.filter(n=>n.id===r)[0];if(t){const n=t.groupData.filter(l=>l.id===o)[0];if(n)t.groupData.length===2?te(r):(delete n.inGroupId,delete n.groupW,delete n.groupH,delete n.groupX,delete n.groupY,delete n.isObstacle,A(n.id,t.id),ee(n),S());else try{}catch{}}else try{}catch{}},te=o=>{const r=a.value.filter(t=>t.id===o)[0];if(r)A(r.id),r.groupData.forEach(t=>{delete t.inGroupId,delete t.groupW,delete t.groupH,delete r.groupX,delete r.groupY,delete r.isObstacle,t.x+=r.x,t.y+=r.y,ee(t,null,!0)}),S();else try{}catch{}},qe=(o="",r)=>{const t=a.value.filter(n=>n.id===r)[0];if(t){if(!t.groupTit||!o){const l=getComputedStyle(z.value),x=parseInt(l.getPropertyValue("--group-tit-height").trim());t.groupTit&&!o&&(t.height-=x),!t.groupTit&&o&&(t.height+=x)}t.groupTit=o;const n=l=>{a.value.filter(f=>f.id!==l.id).filter(f=>f.x<l.x&&f.x+f.width>l.x||f.x===l.x||f.x>l.x&&f.x<l.x+l.width).filter(f=>f.y<l.y&&f.y+f.height>l.y||f.y===l.y||f.y>l.y&&f.y<l.y+l.height).forEach(f=>{f.y=l.y+l.height,n(f)})};n(t),S()}else try{}catch{}},Ue=()=>({data:O(a.value),width:H});return e.onBeforeUnmount(()=>{ye.unobserve(z.value),window.removeEventListener("click",F)}),T({init:Le,addItem:ee,deleteItem:A,updateItem:re,openGroup:ke,closeGroup:Me,addGroup:Fe,removeGroupItem:Ee,removeGroup:te,changeGroupTit:qe,getData:Ue}),(o,r)=>(e.openBlock(),e.createElementBlock("div",{class:"vue-drag-component-plus",ref_key:"pageRef",ref:z},[e.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:K},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["com-item",E.seeModel||e.unref(N)||t.static===!0||t.dragable===!1?"":"can-drag",t.move?"is-move":"",t.drag?"is-drag":"",t.showPop?"on-top":"",E.seeModel?"no-hover":""]),style:e.normalizeStyle({width:t.width+"px",height:t.height+"px",top:t.y+"px",left:t.x+"px"}),key:n,onMousedown:e.withModifiers(l=>E.seeModel||e.unref(N)||t.static===!0||t.dragable===!1?null:$e(l,n),["prevent"])},[e.createElementVNode("div",Be,[t.isGroup?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t.groupTit?(e.openBlock(),e.createElementBlock("div",{key:0,class:"group-item-tit",title:t.groupTit},e.toDisplayString(t.groupTit),9,ve)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["group-item-content",t.groupTit?"":"full"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.groupData,(l,x)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["com-item-content-child",l.isObstacle?"else":""]),style:e.normalizeStyle({width:l.width+"px",height:l.height+"px",top:l.y+"px",left:l.x+"px"}),key:x},[e.renderSlot(o.$slots,"item",{data:l},()=>[e.createElementVNode("p",null,e.toDisplayString(l.width)+","+e.toDisplayString(l.height),1),e.createElementVNode("p",null,e.toDisplayString(l.x)+","+e.toDisplayString(l.y),1)]),!E.seeModel&&!e.unref(N)&&e.unref(m)===null&&e.unref(u)===null?(e.openBlock(),e.createElementBlock("div",{key:0,class:"setting-box",style:e.normalizeStyle({display:l.showPop?"flex":"none"}),onMousedown:e.withModifiers(f=>null,["prevent","stop"])},[e.createVNode(R,{iconObj:E.settingIcon,onClick:e.withModifiers(f=>we(l),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):e.createCommentVNode("",!0),l.showPop?(e.openBlock(),e.createElementBlock("div",{key:1,class:"setting-box-pop",onMousedown:e.withModifiers(f=>null,["prevent","stop"])},[e.renderSlot(o.$slots,"setPopNormal",{data:O(l)},()=>[e.createElementVNode("div",{class:"setting-box-pop-item",onClick:f=>Ee(l.id,l.inGroupId)},"移出组合",8,Ce),e.createElementVNode("div",{class:"setting-box-pop-item",onClick:f=>A(l.id,l.inGroupId)},"删除",8,De)])],32)):e.createCommentVNode("",!0)],6))),128))],2)],64)):e.renderSlot(o.$slots,"item",{key:1,data:t},()=>[e.createElementVNode("p",null,e.toDisplayString(t.width)+","+e.toDisplayString(t.height),1),e.createElementVNode("p",null,e.toDisplayString(t.x)+","+e.toDisplayString(t.y),1)]),!t.isGroup&&t.notGroup!==!0&&e.unref(N)?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["group-checkbox",t.checked?"is-checked":"",t.disabled?"disabled":""]),onClick:l=>t.disabled?null:Ke(t)},null,10,Oe)):e.createCommentVNode("",!0),!E.seeModel&&!e.unref(N)&&e.unref(m)===null&&e.unref(u)===null?(e.openBlock(),e.createElementBlock("div",{key:3,class:"setting-box",style:e.normalizeStyle({display:t.showPop?"flex":"none"}),onMousedown:e.withModifiers(l=>null,["prevent","stop"])},[e.createVNode(R,{iconObj:E.settingIcon,onClick:e.withModifiers(l=>we(t),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):e.createCommentVNode("",!0),t.showPop?(e.openBlock(),e.createElementBlock("div",{key:4,class:e.normalizeClass(["setting-box-pop",t.isGroup===!0?"special":""]),onMousedown:e.withModifiers(l=>null,["prevent","stop"])},[t.isGroup===!0?e.renderSlot(o.$slots,"setPopSpecial",{key:0,data:O(t)},()=>[E.hideTit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:l=>_("showTitPop",t.groupTit,t.id)}," 设置组合标题",8,Ve)),e.createElementVNode("div",{class:"setting-box-pop-item",onClick:l=>te(t.id)},"解除组合",8,Se)]):e.renderSlot(o.$slots,"setPopNormal",{key:1,data:O(t)},()=>[t.notGroup!==!0?(e.openBlock(),e.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:l=>ke(t.id)},"组合",8,ze)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"setting-box-pop-item",onClick:l=>A(t.id)},"删除",8,Ne)])],34)):e.createCommentVNode("",!0)]),!E.seeModel&&!e.unref(N)&&!t.move&&t.static!==!0&&t.resizable!==!1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(G).indexOf("topLeft")!==-1?(e.openBlock(),e.createElementBlock("div",{key:0,class:"resize-line top-left",onMousedown:e.withModifiers(l=>P(l,t,"top-left"),["prevent","stop"])},null,40,Ge)):e.createCommentVNode("",!0),e.unref(G).indexOf("top")!==-1?(e.openBlock(),e.createElementBlock("div",{key:1,class:"resize-line top",onMousedown:e.withModifiers(l=>P(l,t,"top"),["prevent","stop"])},null,40,He)):e.createCommentVNode("",!0),e.unref(G).indexOf("topRight")!==-1?(e.openBlock(),e.createElementBlock("div",{key:2,class:"resize-line top-right",onMousedown:e.withModifiers(l=>P(l,t,"top-right"),["prevent","stop"])},null,40,We)):e.createCommentVNode("",!0),e.unref(G).indexOf("left")!==-1?(e.openBlock(),e.createElementBlock("div",{key:3,class:"resize-line left",onMousedown:e.withModifiers(l=>P(l,t,"left"),["prevent","stop"])},null,40,Pe)):e.createCommentVNode("",!0),e.unref(G).indexOf("right")!==-1?(e.openBlock(),e.createElementBlock("div",{key:4,class:"resize-line right",onMousedown:e.withModifiers(l=>P(l,t,"right"),["prevent","stop"])},null,40,Te)):e.createCommentVNode("",!0),e.unref(G).indexOf("bottomLeft")!==-1?(e.openBlock(),e.createElementBlock("div",{key:5,class:"resize-line bottom-left",onMousedown:e.withModifiers(l=>P(l,t,"bottom-left"),["prevent","stop"])},null,40,Ie)):e.createCommentVNode("",!0),e.unref(G).indexOf("bottom")!==-1?(e.openBlock(),e.createElementBlock("div",{key:6,class:"resize-line bottom",onMousedown:e.withModifiers(l=>P(l,t,"bottom"),["prevent","stop"])},null,40,Ye)):e.createCommentVNode("",!0),e.unref(G).indexOf("bottomRight")!==-1?(e.openBlock(),e.createElementBlock("div",{key:7,class:"resize-line bottom-right",onMousedown:e.withModifiers(l=>P(l,t,"bottom-right"),["prevent","stop"])},null,40,Xe)):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],46,me))),128)),e.unref(m)!==null?(e.openBlock(),e.createElementBlock("div",{key:0,class:"drag-bg",style:e.normalizeStyle({width:e.unref(C).width+"px",height:e.unref(C).height+"px",top:e.unref(C).y+"px",left:e.unref(C).x+"px"})},null,4)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"height-bg",style:e.normalizeStyle({height:e.unref(U)+"px"})},null,4),e.unref(a).length===0?(e.openBlock(),e.createElementBlock("div",be,[e.renderSlot(o.$slots,"empty",{},()=>[e.createTextVNode(" 暂无数据 ")])])):e.createCommentVNode("",!0)],512)],512))}}],ne={install(E){Re.forEach(T=>{E.component("vueDragComponentPlus",T)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(ne),ne});
