(function(t,R){typeof exports=="object"&&typeof module<"u"?module.exports=R(require("vue")):typeof define=="function"&&define.amd?define(["vue"],R):(t=typeof globalThis<"u"?globalThis:t||self,t.vueDragComponentPlus=R(t.Vue))})(this,function(t){"use strict";const R={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(m){return(G,ht)=>{const $=t.resolveComponent("el-icon");return m.iconObj.type==="custom"?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(m.iconObj.icon),t.normalizeProps(t.mergeProps({key:0},m.iconObj.attrs)),null,16)):m.iconObj.type==="el"?(t.openBlock(),t.createBlock($,t.normalizeProps(t.mergeProps({key:1},m.iconObj.attrs)),{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(m.iconObj.icon)))]),_:1},16)):m.iconObj.type==="iconfont"?(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:2,class:["icon iconfont","icon-"+m.iconObj.icon]},m.iconObj.attrs),null,16)):(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:3,class:m.iconObj.type},m.iconObj.attrs),t.toDisplayString(m.iconObj.icon),17))}}},oe="",St=["onMousedown"],Vt={class:"com-item-box"},Nt=["title"],Ot={class:"com-item-box-content"},zt=["onClick"],Pt=["onClick"],Gt={key:1,class:"com-item-box-content"},Wt=["onClick"],Ht=["onClick"],Tt=["onClick"],It=["onClick"],Yt=["onClick"],Xt=["onMousedown"],vt=["onMousedown"],Lt=["onMousedown"],Rt=["onMousedown"],$t=["onMousedown"],_t=["onMousedown"],At=["onMousedown"],bt=["onMousedown"],Kt={key:2,class:"com-empty"},Ft=[{__name:"index",props:{insertResizeKeys:{type:Array,default:()=>["topLeft","top","topRight","left","right","bottomLeft","bottom","bottomRight"]},excludeResizeKeys:{type:Array,default:()=>[]},seeModel:{type:Boolean,default:!1},seeModelMinBg:{type:Number,default:50,validator(m,G){return m>=0}},itemMinWidth:{type:Number,default:15,validator(m,G){return m>=15}},itemMinHeight:{type:Number,default:15,validator(m,G){return m>=15}},ySpace:{type:Number,default:7,validator(m,G){return m>=0}},settingIcon:{type:Object,default:()=>({icon:"设置"})},hideTit:{type:Boolean,default:!1},hideAuxiliary:{type:Boolean,default:!1},auxiliarySpace:{type:Number,default:15,validator(m,G){return m>=1}}},emits:["showGroup","updateChecked","showTitPop"],setup(m,{expose:G,emit:ht}){const $=ht,M=m,S=o=>{if(typeof o=="object"&&!t.isVNode(o)&&o!==null&&!(o instanceof Date)){let l=o instanceof Array?[]:{};for(let e in o)l[e]=typeof o[e]=="object"&&!t.isVNode(o[e])&&o[e]!==null&&!(o[e]instanceof Date)?S(o[e]):o[e];return l}else return o},dt=()=>{M.insertResizeKeys.forEach(o=>{M.excludeResizeKeys.indexOf(o)===-1&&W.value.push(o)})};t.watch(()=>[M.insertResizeKeys,M.excludeResizeKeys],()=>{dt()});const W=t.ref([]);dt();const z=t.ref(null);let H=null,pt=null;const qt=t.ref(null),F=t.ref(0),q=t.ref(null),U=t.ref(null),J=t.ref(null),Q=t.ref(null),_=o=>{const l=S(o);if(o===null)q.value=null,U.value=null,J.value=null,Q.value=null;else{const e=getComputedStyle(z.value),i=parseInt(e.getPropertyValue("--auxiliary-width").trim()),r=p.value.filter(n=>n.id!==l.id).map(n=>n.y),w=p.value.filter(n=>n.id!==l.id).map(n=>n.y+n.height-1),d=[...r,...w];d.sort(),d.filter(n=>n<=l.y&&l.y-M.auxiliarySpace<n||n>=l.y&&l.y+M.auxiliarySpace>n).length>0?q.value=l.y:q.value=null,d.filter(n=>n<=l.y+l.height-1&&l.y+l.height-1-M.auxiliarySpace<n||n>=l.y+l.height-1&&l.y+l.height-1+M.auxiliarySpace>n).length>0?U.value=l.y+l.height-i:U.value=null;const k=p.value.filter(n=>n.id!==l.id).map(n=>n.x),g=p.value.filter(n=>n.id!==l.id).map(n=>n.x+n.width-1),c=[...k,...g];c.sort(),c.filter(n=>n<=l.x&&l.x-M.auxiliarySpace<n||n>=l.x&&l.x+M.auxiliarySpace>n).length>0?J.value=l.x:J.value=null,c.filter(n=>n<=l.x+l.width-1&&l.x+l.width-1-M.auxiliarySpace<n||n>=l.x+l.width-1&&l.x+l.width-1+M.auxiliarySpace>n).length>0?Q.value=l.x+l.width-i:Q.value=null}},p=t.ref([]),Ut=(o,l)=>{let e=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector;for(;o&&!e.call(o,l);)o=o.parentElement;return o};let D=null,yt=null,ft=null;const V=t.ref({}),Jt=(o,l)=>{Z(),D=l,V.value=S(p.value[D]),p.value[D].move=!0,_(p.value[D]);const e=Ut(o.target,".com-item");yt=o.clientX-e.offsetLeft,ft=o.clientY-e.offsetTop,window.addEventListener("mousemove",ut),window.addEventListener("mouseup",gt)},ut=o=>{const l=o.clientX-yt,e=o.clientY-ft,i=l<=T("left")?T("left"):l>=T("right")?T("right"):l,r=e<=T("top")?T("top"):e>=T("bottom")?T("bottom"):e,w=i-p.value[D].x,d=r-p.value[D].y,k=`${w>3?"right":w<-3?"left":""}_${d>0?"bottom":d<0?"top":""}`;p.value[D].x=i,p.value[D].y=r,_(p.value[D]);let g=S(p.value.filter(c=>c.move!==!0).filter(c=>c.x<i&&c.x+c.width>i||c.x===i||c.x>i&&c.x<i+p.value[D].width).filter(c=>c.y<r&&c.y+c.height>r||c.y===r||c.y>r&&c.y<r+p.value[D].height));if(g.length===0)V.value.x=i,V.value.y=r;else{if(k.indexOf("top")!==-1){g=g.filter(h=>h.y<V.value.y);const c=Math.min(...g.map(h=>h.y+h.height));g.forEach(h=>{Math.abs(h.y+h.height-c)<5&&(h.y=c-h.height)});let n=V.value.y-r,y=!0,s=[...g];const a=h=>{S(p.value.filter(f=>f.move!==!0&&f.y+f.height-h.y<=n+3&&f.y+f.height-h.y>=0).filter(f=>f.x<h.x&&f.x+f.width>h.x||f.x>=h.x&&f.x<h.x+h.width)).forEach(f=>{f.y+f.height!==h.y&&(f.y=h.y-f.height),s.findIndex(C=>C.id===f.id)===-1&&(s.push(f),a(f))})};if(g.forEach(h=>{a(h)}),s.sort((h,x)=>{const f=h.y,C=x.y;return f-C}),(s.length===0||s.filter(h=>h.y===0).length>0)&&(y=!1),y){let h=0;s.filter(f=>f.y===s[0].y).forEach(f=>{S(p.value.filter(E=>E.move!==!0&&E.y+E.height<f.y).filter(E=>E.x<f.x&&E.x+E.width>f.x||E.x>=f.x&&E.x<f.x+f.width)).forEach(E=>{E.y+E.height>h&&(h=E.y+E.height)})}),h=s[0].y-h,h<n&&(n=h),s.forEach(f=>{f.y-=n,p.value.filter(C=>C.id===f.id)[0].y=f.y}),V.value.x=i,V.value.y=p.value.filter(f=>f.id===s[s.length-1].id)[0].y+p.value.filter(f=>f.id===s[s.length-1].id)[0].height}else{const h=Math.min(...g.map(x=>x.y));h-r>=-7&&h-r<7&&(g.filter(x=>x.y<V.value.y).forEach(x=>{x.y+=p.value[D].height,p.value.filter(C=>C.id===x.id)[0].y=x.y;const f=C=>{p.value.filter(N=>N.move!==!0&&N.id!==C.id).filter(N=>N.x<C.x&&N.x+N.width>C.x||N.x===C.x||N.x>C.x&&N.x<C.x+C.width).filter(N=>N.y<C.y&&N.y+N.height>C.y||N.y===C.y||N.y>C.y&&N.y<C.y+C.height).forEach(N=>{N.y=C.y+C.height,f(N)})};f(x)}),V.value.x=i,V.value.y=h)}g=S(p.value.filter(h=>h.move!==!0).filter(h=>h.x<i&&h.x+h.width>i||h.x===i||h.x>i&&h.x<i+p.value[D].width).filter(h=>h.y<r&&h.y+h.height>r||h.y===r||h.y>r&&h.y<r+p.value[D].height))}if(k.indexOf("bottom")!==-1){let c=0;g.forEach(s=>{const a=p.value.filter(h=>h.move!==!0).filter(h=>h.x<s.x&&h.x+h.width>s.x||h.x===s.x||h.x>s.x&&h.x<s.x+s.width).filter(h=>h.y+h.height<s.y);a.length>0&&(c=Math.max(...a.map(h=>h.y+h.height)))});const n=c+(Math.max(...g.map(s=>s.height+s.y))-Math.min(...g.map(s=>s.y))),y=Math.min(...g.map(s=>s.y))-c;if(r>=n){let s=!0;g.filter(a=>a.y>V.value.y).forEach(a=>{a.y-=y,p.value.filter(x=>x.id===a.id)[0].y=a.y;const h=p.value.filter(x=>x.move!==!0&&x.id!==a.id).filter(x=>x.x<a.x&&x.x+x.width>a.x||x.x===a.x||x.x>a.x&&x.x<a.x+a.width).filter(x=>x.y<a.y&&x.y+x.height>a.y||x.y===a.y||x.y>a.y&&x.y<a.y+a.height);if(h.length>0){a.y=Math.max(...h.map(f=>f.y+f.height)),p.value.filter(f=>f.id===a.id)[0].y=a.y;const x=f=>{p.value.filter(E=>E.id!==f.id).filter(E=>E.x<f.x&&E.x+E.width>f.x||E.x===f.x||E.x>f.x&&E.x<f.x+f.width).filter(E=>E.y<f.y&&E.y+E.height>f.y||E.y===f.y||E.y>f.y&&E.y<f.y+f.height).forEach(E=>{E.y=f.y+f.height,E.move===!0&&(V.value.y=E.y,s=!1),x(E)})};x(a)}}),V.value.x=i,s&&(V.value.y=n),g=S(p.value.filter(a=>a.move!==!0).filter(a=>a.x<i&&a.x+a.width>i||a.x===i||a.x>i&&a.x<i+p.value[D].width).filter(a=>a.y<r&&a.y+a.height>r||a.y===r||a.y>r&&a.y<r+p.value[D].height))}}if(((k.indexOf("top")!==-1||k.indexOf("bottom")!==-1)&&(k.indexOf("right")!==-1||k.indexOf("left")!==-1)&&Math.abs(w)>8||k.indexOf("top")===-1&&k.indexOf("bottom")===-1&&(k.indexOf("right")!==-1||k.indexOf("left")!==-1))&&g.length>0){g.sort((n,y)=>{const s=n.y,a=y.y;return s-a});let c=!0;for(let n=0;n<g.length;n++){if(c){const y=S(p.value);for(let s=0;s<=n;s++){let a=null;const h=y.filter(x=>x.move!==!0&&x.y<g[s].y).filter(x=>x.x<g[s].x&&x.x+x.width>g[s].x||x.x===g[s].x||x.x>g[s].x&&x.x<g[s].x+g[s].width);if(h.length===0?a=0:a=Math.max(...h.map(x=>x.y+x.height)),s===n){if(g[s].y-(g[s].y+g[s].height-r)<a){c=!1;break}}else if(g[s].y-g[n].height<a){c=!1;break}else y.filter(x=>x.id===g[s].id)[0].y-=g[n].height}}if(c){g[n].y-=g[n].y+g[n].height-r,p.value.filter(y=>y.id===g[n].id)[0].y=g[n].y;for(let y=n;y>0;y--)g[n-1].y-=g[n].height,p.value.filter(s=>s.id===g[n-1].id)[0].y=g[n-1].y}else g.filter(y=>y.id===g[n].id).forEach(y=>{y.y+=p.value[D].y+p.value[D].height-y.y,p.value.filter(a=>a.id===y.id)[0].y=y.y;const s=a=>{p.value.filter(x=>x.move!==!0&&x.id!==a.id).filter(x=>x.x<a.x&&x.x+x.width>a.x||x.x===a.x||x.x>a.x&&x.x<a.x+a.width).filter(x=>x.y<a.y&&x.y+x.height>a.y||x.y===a.y||x.y>a.y&&x.y<a.y+a.height).forEach(x=>{x.y=a.y+a.height,s(x)})};s(y)})}V.value.x=i}}O(!1)},gt=()=>{window.removeEventListener("mousemove",ut),window.removeEventListener("mouseup",gt),delete p.value[D].move,p.value[D].x=V.value.x,p.value[D].y=V.value.y,D=null,_(null),O()},T=o=>{switch(o){case"top":return 0;case"right":return H-p.value[D].width;case"bottom":return 999999999;case"left":return 0}};let u=null,at="",tt=0,et=0,Y=0,X=0,v=0,L=0,A=0,lt=0,b=0,rt=0;const I=(o,l,e)=>{Z(),u=l,at=e,tt=o.clientX,et=o.clientY,Y=l.width,X=l.height,v=l.y,L=l.x,u.drag=!0,_(u);const i=p.value.filter(c=>c.static===!0&&(c.x<l.x?c.x+c.width>=l.x:c.x<=l.x+l.width)),r=p.value.filter(c=>c.static===!0&&(c.y<l.y?c.y+c.height>=l.y:c.y<=l.y+l.height)),w=i.filter(c=>c.y+c.height<=l.y).map(c=>c.y+c.height);w.length>0?A=Math.max(...w):A=0;const d=i.filter(c=>c.y>=l.y+l.height).map(c=>c.y);d.length>0?lt=Math.min(...d):lt=0;const k=r.filter(c=>c.x+c.width<=l.x).map(c=>c.x+c.width);k.length>0?b=Math.max(...k):b=0;const g=r.filter(c=>c.x>=l.x+l.width).map(c=>c.x);g.length>0?rt=Math.min(...g):rt=0,window.addEventListener("mousemove",xt),window.addEventListener("mouseup",wt)},xt=o=>{const l=Y+(o.clientX-tt),e=X+(o.clientY-et),i=Y-(o.clientX-tt),r=X-(o.clientY-et),w=v+(o.clientY-et),d=L+(o.clientX-tt),k=getComputedStyle(z.value),g=parseInt(k.getPropertyValue("--com-item-border-width").trim()),c=parseInt(k.getPropertyValue("--group-tit-height").trim());switch(at){case"top-left":if(u.height=r<M.itemMinHeight?M.itemMinHeight:r>B("top")?B("top"):r,u.y=r<M.itemMinHeight?v+X-M.itemMinHeight:r>B("top")?A:w,u.width=i<M.itemMinWidth?M.itemMinWidth:i>B("left")?B("left"):i,u.x=i<M.itemMinWidth?L+Y-M.itemMinWidth:i>B("left")?b:d,u.isGroup===!0){const y=u.width-2*g,s=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(a=>{a.width=y*a.groupW,a.x=y*a.groupX,a.height=s*a.groupH,a.y=s*a.groupY})}break;case"top":if(u.height=r<M.itemMinHeight?M.itemMinHeight:r>B("top")?B("top"):r,u.y=r<M.itemMinHeight?v+X-M.itemMinHeight:r>B("top")?A:w,u.isGroup===!0){const y=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(s=>{s.height=y*s.groupH,s.y=y*s.groupY})}break;case"top-right":if(u.height=r<M.itemMinHeight?M.itemMinHeight:r>B("top")?B("top"):r,u.y=r<M.itemMinHeight?v+X-M.itemMinHeight:r>B("top")?A:w,u.width=l<M.itemMinWidth?M.itemMinWidth:l>B("right")?B("right"):l,u.isGroup===!0){const y=u.width-2*g,s=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(a=>{a.width=y*a.groupW,a.x=y*a.groupX,a.height=s*a.groupH,a.y=s*a.groupY})}break;case"left":if(u.width=i<M.itemMinWidth?M.itemMinWidth:i>B("left")?B("left"):i,u.x=i<M.itemMinWidth?L+Y-M.itemMinWidth:i>B("left")?b:d,u.isGroup===!0){const y=u.width-2*g;u.groupData.forEach(s=>{s.width=y*s.groupW,s.x=y*s.groupX})}break;case"right":if(u.width=l<M.itemMinWidth?M.itemMinWidth:l>B("right")?B("right"):l,u.isGroup===!0){const y=u.width-2*g;u.groupData.forEach(s=>{s.width=y*s.groupW,s.x=y*s.groupX})}break;case"bottom-left":if(u.height=e<M.itemMinHeight?M.itemMinHeight:e>B("bottom")?B("bottom"):e,u.width=i<M.itemMinWidth?M.itemMinWidth:i>B("left")?B("left"):i,u.x=i<M.itemMinWidth?L+Y-M.itemMinWidth:i>B("left")?b:d,u.isGroup===!0){const y=u.width-2*g,s=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(a=>{a.width=y*a.groupW,a.x=y*a.groupX,a.height=s*a.groupH,a.y=s*a.groupY})}break;case"bottom":if(u.height=e<M.itemMinHeight?M.itemMinHeight:e>B("bottom")?B("bottom"):e,u.isGroup===!0){const y=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(s=>{s.height=y*s.groupH,s.y=y*s.groupY})}break;case"bottom-right":if(u.height=e<M.itemMinHeight?M.itemMinHeight:e>B("bottom")?B("bottom"):e,u.width=l<M.itemMinWidth?M.itemMinWidth:l>B("right")?B("right"):l,u.isGroup===!0){const y=u.width-2*g,s=u.height-2*g-(u.groupTit?c:0);u.groupData.forEach(a=>{a.width=y*a.groupW,a.x=y*a.groupX,a.height=s*a.groupH,a.y=s*a.groupY})}break}_(u);let n=S(p.value.filter(y=>y.drag!==!0).filter(y=>y.x<u.x&&y.x+y.width>u.x||y.x===u.x||y.x>u.x&&y.x<u.x+u.width).filter(y=>y.y<u.y&&y.y+y.height>u.y||y.y===u.y||y.y>u.y&&y.y<u.y+u.height));if(n.length>0){n.sort((y,s)=>{const a=y.y,h=s.y;return a-h});for(let y=0;y<n.length;y++)n.filter(s=>s.id===n[y].id).forEach(s=>{s.y+=u.y+u.height-s.y,p.value.filter(h=>h.id===s.id)[0].y=s.y;const a=h=>{p.value.filter(f=>f.drag!==!0&&f.id!==h.id).filter(f=>f.x<h.x&&f.x+f.width>h.x||f.x===h.x||f.x>h.x&&f.x<h.x+h.width).filter(f=>f.y<h.y&&f.y+f.height>h.y||f.y===h.y||f.y>h.y&&f.y<h.y+h.height).forEach(f=>{f.y=h.y+h.height,a(f)})};a(s)})}O(!1)},wt=o=>{delete u.drag,at="",u=null,_(null),window.removeEventListener("mousemove",xt),window.removeEventListener("mouseup",wt),O()},B=o=>{switch(o){case"top":return v+X-A;case"left":return L+Y-b;case"right":return(rt>0?rt:H)-L;case"bottom":return lt>0?lt-v:999999999}},O=(o=!0)=>{o===!0&&kt();const l=p.value.map(e=>e.y+e.height);l.length>0?F.value=Math.max(...l):F.value=0};t.watch(()=>M.ySpace,()=>{M.ySpace>=0&&kt()});const kt=()=>{const o=S(p.value).sort((l,e)=>{const i=l.y,r=e.y;return i-r});for(let l=0;l<o.length;l++){if(l===0&&o[l].y>0){const e=o[l].y;for(let i=l;i<o.length;i++)o[i].y-=e,p.value.filter(r=>r.id===o[i].id)[0].y=o[i].y}if(l<o.length-1&&o[l+1].y>o[l].y+o[l].height){const e=S(o.slice(0,l+1));if(o[l+1].y>Math.max(...e.map(i=>i.y+i.height))){const i=o[l+1].y-Math.max(...e.map(r=>r.y+r.height));for(let r=l+1;r<o.length;r++)o[r].y-=i,p.value.filter(w=>w.id===o[r].id)[0].y=o[r].y}}}for(let l=0;l<o.length-1;l++){let e=o.findIndex(i=>i.y===o[l].y+o[l].height);if(e!==-1)for(let i=e;i<o.length;i++)o[i].y+=M.ySpace,p.value.filter(r=>r.id===o[i].id)[0].y=o[i].y}};t.onMounted(()=>{Mt.observe(z.value)});const Mt=new ResizeObserver(o=>{Zt(H===o[0].contentRect.width?null:o[0].contentRect.width,pt===o[0].contentRect.height?null:o[0].contentRect.height)});let st=!1;const Qt=(o=[],l=null)=>{p.value=S(o),p.value.filter(e=>e.isGroup===!0).forEach(e=>{if(e.isGroup===!0)if(e.groupData.length<2)j(e.id);else{const i=nt(e.groupData,e);it(i)}}),l!==null?t.nextTick(()=>{const i=z.value.getBoundingClientRect().width/l,r=getComputedStyle(z.value),w=parseInt(r.getPropertyValue("--com-item-border-width").trim()),d=parseInt(r.getPropertyValue("--group-tit-height").trim());p.value.forEach(k=>{if(k.width*=i,k.height*=i,k.x*=i,k.y*=i,k.isGroup===!0){const g=k.width-2*w,c=k.height-2*w-(k.groupTit?d:0);k.groupData.forEach(n=>{n.width=g*n.groupW,n.x=g*n.groupX,n.height=c*n.groupH,n.y=c*n.groupY})}}),O()}):O(),st=!0,setTimeout(()=>{st=!1},500)},mt=(o,l,e)=>{const i=l.map(d=>d.y),r=Math.max(...i),w=l.filter(d=>d.y+d.height>r);w.sort((d,k)=>{const g=d.x,c=k.x;return g-c});for(let d=0;d<w.length;d++){if(d===0&&w[d].x>=o.width){o.y=r,o.x=0;break}if(w.length>1&&d!==w.length-1&&w[d].x+w[d].width+o.width<=w[d+1].x){o.y=r,o.x=w[d].x+w[d].width;break}if(d===w.length-1&&w[d].x+w[d].width+o.width<=e){o.y=r,o.x=w[d].x+w[d].width;break}}if(o.y==null){o.x=0;const d=l.map(k=>k.y+k.height);o.y=Math.max(...d)}},ot=(o,l=null,e=!1)=>{const i=S(o),r=p.value.filter(w=>w.id===l);if(i.id||(i.id=new Date().getTime()+""),l&&r.length!==1){try{}catch{}return}if(e!==!0)if(delete i.x,delete i.y,l){const w=getComputedStyle(z.value),d=parseInt(w.getPropertyValue("--com-item-border-width").trim());mt(i,r[0].groupData,r[0].width-2*d)}else p.value.length===0?(i.x=0,i.y=0):mt(i,p.value,H);if(l){r[0].groupData.push(i);const w=nt(r[0].groupData,r[0]);it(w);const d=k=>{p.value.filter(c=>c.id!==k.id).filter(c=>c.x<k.x&&c.x+c.width>k.x||c.x===k.x||c.x>k.x&&c.x<k.x+k.width).filter(c=>c.y<k.y&&c.y+c.height>k.y||c.y===k.y||c.y>k.y&&c.y<k.y+k.height).forEach(c=>{c.y=k.y+k.height,d(c)})};d(w)}else p.value.push(i);O()},K=(o,l=null)=>{let e=-1;const i=p.value.filter(r=>r.id===l);if(l?i.length===1&&(e=i[0].groupData.findIndex(r=>r.id===o)):e=p.value.findIndex(r=>r.id===o),e!==-1){if(l)if(i[0].groupData.splice(e,1),i[0].groupData.length===1)j(l);else{const r=nt(i[0].groupData,i[0]);it(r)}else p.value.splice(e,1);O()}else try{}catch{}},it=o=>{if(o.id){const l=S(o);delete l.showPop,l.groupData&&l.groupData.forEach(r=>{delete r.showPop});let e=-1;const i=p.value.filter(r=>r.id===l.inGroupId);if(l.inGroupId?i.length===1&&(e=i[0].groupData.findIndex(r=>r.id===l.id)):e=p.value.findIndex(r=>r.id===l.id),e!==-1)l.inGroupId?i[0].groupData[e]=l:p.value[e]=l,O();else try{}catch{}}else try{}catch{}},Zt=(o,l)=>{if(o!==null){const e=H?o/H:1;H=o;const i=getComputedStyle(z.value),r=parseInt(i.getPropertyValue("--com-item-border-width").trim()),w=parseInt(i.getPropertyValue("--group-tit-height").trim());st||(p.value.forEach(d=>{if(d.width*=e,d.height*=e,d.x*=e,d.y*=e,d.isGroup===!0){const k=d.width-2*r,g=d.height-2*r-(d.groupTit?w:0);d.groupData.forEach(c=>{c.width=k*c.groupW,c.x=k*c.groupX,c.height=g*c.groupH,c.y=g*c.groupY})}}),O())}l!==null&&(pt=l)},Et=o=>{o.showPop||(p.value.forEach(l=>{delete l.showPop,l.groupData&&l.groupData.forEach(e=>{delete e.showPop})}),o.showPop=!0,window.addEventListener("click",Z))},Z=()=>{p.value.forEach(o=>{delete o.showPop,o.groupData&&o.groupData.forEach(l=>{delete l.showPop})}),window.removeEventListener("click",Z)},P=t.ref(!1),Bt=o=>{const l=p.value.findIndex(e=>e.id===o);if(l!==-1)p.value[l].checked=!0,p.value[l].disabled=!0,P.value=!0,$("showGroup",P.value);else try{}catch{}},Dt=()=>{P.value=!1,p.value.forEach(o=>{delete o.checked,delete o.disabled,o.groupData&&o.groupData.forEach(l=>{delete l.checked,delete l.disabled})}),$("showGroup",P.value)},jt=o=>{o.checked=!o.checked,$("updateChecked",p.value.filter(l=>l.checked).length)},nt=(o,l)=>{const e=S(o),i=S(l);e.sort((n,y)=>{const s=n.x,a=y.x;return s-a});for(let n=0;n<e.length-1;n++){if(n===0&&e[n].x>0){const y=e[n].x;for(let s=n;s<e.length;s++)e[s].x-=y}if(e[n+1].x>e[n].x+e[n].width){const y=S(e.slice(0,n+1));if(e[n+1].x>Math.max(...y.map(s=>s.x+s.width))){const s=e[n+1].x-Math.max(...y.map(a=>a.x+a.width));for(let a=n+1;a<e.length;a++)e[a].x-=s}}}e.sort((n,y)=>{const s=n.y,a=y.y;return s-a});for(let n=0;n<e.length-1;n++){if(n===0&&e[n].y>0){const y=e[n].y;for(let s=n;s<e.length;s++)e[s].y-=y}if(e[n+1].y>e[n].y+e[n].height){const y=S(e.slice(0,n+1));if(e[n+1].y>Math.max(...y.map(s=>s.y+s.height))){const s=e[n+1].y-Math.max(...y.map(a=>a.y+a.height));for(let a=n+1;a<e.length;a++)e[a].y-=s}}}const r=e.map(n=>n.x+n.width),w=Math.max(...r),d=e.map(n=>n.y+n.height),k=Math.max(...d);e.forEach(n=>{n.inGroupId||(n.inGroupId=i.id),n.groupW=n.width/w,n.groupH=n.height/k,n.groupX=n.x/w,n.groupY=n.y/k,n.isObstacle=n.x+n.width===w&&n.y===0});const g=getComputedStyle(z.value),c=parseInt(g.getPropertyValue("--com-item-border-width").trim());return i.width=w+2*c,i.height=k+2*c,i.groupData=[...e],i},te=()=>{t.nextTick(()=>{const o=getComputedStyle(z.value),l=parseInt(o.getPropertyValue("--com-item-border-width").trim()),e=parseInt(o.getPropertyValue("--group-tit-height").trim());p.value.filter(i=>i.isGroup===!0).forEach(i=>{const r=i.width-2*l,w=i.height-2*l-(i.groupTit?e:0);i.groupData.forEach(d=>{d.width=r*d.groupW,d.x=r*d.groupX,d.height=w*d.groupH,d.y=w*d.groupY})})})},ee=()=>{const o=p.value.filter(l=>l.checked);if(o.length>1){const l={id:new Date().getTime()+"G",isGroup:!0,groupTit:""},e=nt(o,l);e.groupData.forEach(i=>{K(i.id)}),ot(e),O()}Dt()},Ct=(o,l)=>{const e=p.value.filter(i=>i.id===l)[0];if(e){const i=e.groupData.filter(r=>r.id===o)[0];if(i)e.groupData.length===2?j(l):(delete i.inGroupId,delete i.groupW,delete i.groupH,delete i.groupX,delete i.groupY,delete i.isObstacle,K(i.id,e.id),ot(i),O());else try{}catch{}}else try{}catch{}},j=o=>{const l=p.value.filter(e=>e.id===o)[0];if(l)l.groupData.forEach(e=>{delete e.inGroupId,delete e.groupW,delete e.groupH,delete l.groupX,delete l.groupY,delete l.isObstacle,e.x+=l.x,e.y+=l.y,ot(e,null,!0)}),K(l.id),O();else try{}catch{}},le=(o="",l)=>{const e=p.value.filter(i=>i.id===l)[0];if(e){if(!e.groupTit||!o){const r=getComputedStyle(z.value),w=parseInt(r.getPropertyValue("--group-tit-height").trim());e.groupTit&&!o&&(e.height-=w),!e.groupTit&&o&&(e.height+=w)}e.groupTit=o;const i=r=>{p.value.filter(d=>d.id!==r.id).filter(d=>d.x<r.x&&d.x+d.width>r.x||d.x===r.x||d.x>r.x&&d.x<r.x+r.width).filter(d=>d.y<r.y&&d.y+d.height>r.y||d.y===r.y||d.y>r.y&&d.y<r.y+r.height).forEach(d=>{d.y=r.y+r.height,i(d)})};i(e),O()}else try{}catch{}},re=()=>(p.value.forEach(o=>{delete o.showPop,o.groupData&&o.groupData.forEach(l=>{delete l.showPop})}),{data:S(p.value),width:H});return t.onBeforeUnmount(()=>{Mt.unobserve(z.value),window.removeEventListener("click",Z)}),G({init:Qt,addItem:ot,deleteItem:K,updateItem:it,openGroup:Bt,closeGroup:Dt,changeGroupBorder:te,addGroup:ee,removeGroupItem:Ct,removeGroup:j,changeGroupTit:le,getData:re}),(o,l)=>(t.openBlock(),t.createElementBlock("div",{class:"vue-drag-component-plus",ref_key:"pageRef",ref:z},[t.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:qt},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(p),(e,i)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item",m.seeModel||t.unref(P)||e.static===!0||e.dragable===!1?"":"can-drag",e.move?"is-move":"",e.drag?"is-drag":"",e.showPop?"on-top":"",m.seeModel?"no-hover":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:i,onMousedown:t.withModifiers(r=>m.seeModel||t.unref(P)||e.static===!0||e.dragable===!1?null:Jt(r,i),["prevent"])},[t.createElementVNode("div",Vt,[e.isGroup?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[e.groupTit?(t.openBlock(),t.createElementBlock("div",{key:0,class:"group-item-tit",title:e.groupTit},t.toDisplayString(e.groupTit),9,Nt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:t.normalizeClass(["group-item-content",e.groupTit?"":"full"])},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.groupData,(r,w)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item-box-child",r.isObstacle?"else":""]),style:t.normalizeStyle({width:r.width+"px",height:r.height+"px",top:r.y+"px",left:r.x+"px"}),key:w},[t.createElementVNode("div",Ot,[t.renderSlot(o.$slots,"item",{data:r},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(r.width*100)/100)+","+t.toDisplayString(Math.round(r.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(r.x*100)/100)+","+t.toDisplayString(Math.round(r.y*100)/100),1)])]),!m.seeModel&&!t.unref(P)&&t.unref(D)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box",style:t.normalizeStyle({display:r.showPop?"flex":"none"}),onMousedown:t.withModifiers(d=>null,["prevent","stop"])},[t.createVNode(R,{iconObj:m.settingIcon,onClick:t.withModifiers(d=>Et(r),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),r.showPop?(t.openBlock(),t.createElementBlock("div",{key:1,class:"setting-box-pop",onMousedown:t.withModifiers(d=>null,["prevent","stop"])},[t.renderSlot(o.$slots,"setPopNormal",{data:S(r)},()=>[t.createElementVNode("div",{class:"setting-box-pop-item",onClick:d=>Ct(r.id,r.inGroupId)},"移出组合",8,zt),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:d=>K(r.id,r.inGroupId)},"删除",8,Pt)])],32)):t.createCommentVNode("",!0)],6))),128))],2)],64)):(t.openBlock(),t.createElementBlock("div",Gt,[t.renderSlot(o.$slots,"item",{data:e},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(e.width*100)/100)+","+t.toDisplayString(Math.round(e.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(e.x*100)/100)+","+t.toDisplayString(Math.round(e.y*100)/100),1)])])),!e.isGroup&&e.notGroup!==!0&&t.unref(P)?(t.openBlock(),t.createElementBlock("div",{key:2,class:t.normalizeClass(["group-checkbox",e.checked?"is-checked":"",e.disabled?"disabled":""]),onClick:r=>e.disabled?null:jt(e)},null,10,Wt)):t.createCommentVNode("",!0),!m.seeModel&&!t.unref(P)&&t.unref(D)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:3,class:"setting-box",style:t.normalizeStyle({display:e.showPop?"flex":"none"}),onMousedown:t.withModifiers(r=>null,["prevent","stop"])},[t.createVNode(R,{iconObj:m.settingIcon,onClick:t.withModifiers(r=>Et(e),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),e.showPop?(t.openBlock(),t.createElementBlock("div",{key:4,class:t.normalizeClass(["setting-box-pop",e.isGroup===!0?"special":""]),onMousedown:t.withModifiers(r=>null,["prevent","stop"])},[e.isGroup===!0?t.renderSlot(o.$slots,"setPopSpecial",{key:0,data:S(e)},()=>[m.hideTit?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:r=>$("showTitPop",e.groupTit,e.id)}," 设置组合标题",8,Ht)),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:r=>j(e.id)},"解除组合",8,Tt)]):t.renderSlot(o.$slots,"setPopNormal",{key:1,data:S(e)},()=>[e.notGroup!==!0?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:r=>Bt(e.id)},"组合",8,It)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:r=>K(e.id)},"删除",8,Yt)])],34)):t.createCommentVNode("",!0)]),!m.seeModel&&!t.unref(P)&&!e.move&&e.static!==!0&&e.resizable!==!1?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.unref(W).indexOf("topLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:0,class:"resize-line top-left",onMousedown:t.withModifiers(r=>I(r,e,"top-left"),["prevent","stop"])},null,40,Xt)):t.createCommentVNode("",!0),t.unref(W).indexOf("top")!==-1?(t.openBlock(),t.createElementBlock("div",{key:1,class:"resize-line top",onMousedown:t.withModifiers(r=>I(r,e,"top"),["prevent","stop"])},null,40,vt)):t.createCommentVNode("",!0),t.unref(W).indexOf("topRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:2,class:"resize-line top-right",onMousedown:t.withModifiers(r=>I(r,e,"top-right"),["prevent","stop"])},null,40,Lt)):t.createCommentVNode("",!0),t.unref(W).indexOf("left")!==-1?(t.openBlock(),t.createElementBlock("div",{key:3,class:"resize-line left",onMousedown:t.withModifiers(r=>I(r,e,"left"),["prevent","stop"])},null,40,Rt)):t.createCommentVNode("",!0),t.unref(W).indexOf("right")!==-1?(t.openBlock(),t.createElementBlock("div",{key:4,class:"resize-line right",onMousedown:t.withModifiers(r=>I(r,e,"right"),["prevent","stop"])},null,40,$t)):t.createCommentVNode("",!0),t.unref(W).indexOf("bottomLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:5,class:"resize-line bottom-left",onMousedown:t.withModifiers(r=>I(r,e,"bottom-left"),["prevent","stop"])},null,40,_t)):t.createCommentVNode("",!0),t.unref(W).indexOf("bottom")!==-1?(t.openBlock(),t.createElementBlock("div",{key:6,class:"resize-line bottom",onMousedown:t.withModifiers(r=>I(r,e,"bottom"),["prevent","stop"])},null,40,At)):t.createCommentVNode("",!0),t.unref(W).indexOf("bottomRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:7,class:"resize-line bottom-right",onMousedown:t.withModifiers(r=>I(r,e,"bottom-right"),["prevent","stop"])},null,40,bt)):t.createCommentVNode("",!0)],64)):t.createCommentVNode("",!0)],46,St))),128)),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(p),(e,i)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["shadow-bg",e.move?"is-move":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:i},null,6))),128)),t.unref(D)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"drag-bg",style:t.normalizeStyle({width:t.unref(V).width+"px",height:t.unref(V).height+"px",top:t.unref(V).y+"px",left:t.unref(V).x+"px"})},null,4)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"height-bg",style:t.normalizeStyle({height:(t.unref(F)>0?+(t.unref(F)+(m.seeModel?m.seeModelMinBg:220)):t.unref(F))+"px"})},null,4),m.hideAuxiliary?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock(t.Fragment,{key:1},[t.unref(q)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"auxiliary-line hor",style:t.normalizeStyle({top:t.unref(q)+"px",left:"0px"})},null,4)):t.createCommentVNode("",!0),t.unref(U)!==null?(t.openBlock(),t.createElementBlock("div",{key:1,class:"auxiliary-line hor",style:t.normalizeStyle({top:t.unref(U)+"px",left:"0px"})},null,4)):t.createCommentVNode("",!0),t.unref(J)!==null?(t.openBlock(),t.createElementBlock("div",{key:2,class:"auxiliary-line",style:t.normalizeStyle({top:"0px",left:t.unref(J)+"px"})},null,4)):t.createCommentVNode("",!0),t.unref(Q)!==null?(t.openBlock(),t.createElementBlock("div",{key:3,class:"auxiliary-line",style:t.normalizeStyle({top:"0px",left:t.unref(Q)+"px"})},null,4)):t.createCommentVNode("",!0)],64)),t.unref(p).length===0?(t.openBlock(),t.createElementBlock("div",Kt,[t.renderSlot(o.$slots,"empty",{},()=>[l[0]||(l[0]=t.createTextVNode(" 暂无数据 "))])])):t.createCommentVNode("",!0)],512)],512))}}],ct={install(m){Ft.forEach(G=>{m.component("vueDragComponentPlus",G)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(ct),ct});
