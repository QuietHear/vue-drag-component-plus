(function(t,$){typeof exports=="object"&&typeof module<"u"?module.exports=$(require("vue")):typeof define=="function"&&define.amd?define(["vue"],$):(t=typeof globalThis<"u"?globalThis:t||self,t.vueDragComponentPlus=$(t.Vue))})(this,function(t){"use strict";const $={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(E){return(W,dt)=>{const A=t.resolveComponent("el-icon");return E.iconObj.type==="custom"?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(E.iconObj.icon),t.normalizeProps(t.mergeProps({key:0},E.iconObj.attrs)),null,16)):E.iconObj.type==="el"?(t.openBlock(),t.createBlock(A,t.normalizeProps(t.mergeProps({key:1},E.iconObj.attrs)),{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(E.iconObj.icon)))]),_:1},16)):E.iconObj.type==="iconfont"?(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:2,class:["icon iconfont","icon-"+E.iconObj.icon]},E.iconObj.attrs),null,16)):(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:3,class:E.iconObj.type},E.iconObj.attrs),t.toDisplayString(E.iconObj.icon),17))}}},ae="",Vt=["onMousedown","onMouseenter","onMouseleave"],Nt={class:"com-item-box"},Ot=["title"],zt={class:"com-item-box-content"},Gt=["onClick"],Pt=["onClick"],Wt={key:1,class:"com-item-box-content"},Ht=["onClick"],Tt=["onClick"],It=["onClick"],Yt=["onClick"],Xt=["onClick"],vt=["onMousedown"],Lt=["onMousedown"],Rt=["onMousedown"],$t=["onMousedown"],At=["onMousedown"],_t=["onMousedown"],bt=["onMousedown"],Ft=["onMousedown"],Kt={key:2,class:"com-empty"},qt=[{__name:"index",props:{insertResizeKeys:{type:Array,default:()=>["topLeft","top","topRight","left","right","bottomLeft","bottom","bottomRight"]},excludeResizeKeys:{type:Array,default:()=>[]},addFirstSpace:{type:Boolean,default:!1},seeModel:{type:Boolean,default:!1},seeModelMinBg:{type:Number,default:50,validator(E,W){return E>=0}},itemMinWidth:{type:Number,default:15,validator(E,W){return E>=15}},itemMinHeight:{type:Number,default:15,validator(E,W){return E>=15}},ySpace:{type:Number,default:7,validator(E,W){return E>=0}},settingIcon:{type:Object,default:()=>({icon:"设置"})},hideTit:{type:Boolean,default:!1},hideAuxiliary:{type:Boolean,default:!1},auxiliarySpace:{type:Number,default:15,validator(E,W){return E>=1}}},emits:["showGroup","updateChecked","showTitPop"],setup(E,{expose:W,emit:dt}){const A=dt,k=E,C=o=>{if(typeof o=="object"&&!t.isVNode(o)&&o!==null&&!(o instanceof Date)){let l=o instanceof Array?[]:{};for(let e in o)l[e]=typeof o[e]=="object"&&!t.isVNode(o[e])&&o[e]!==null&&!(o[e]instanceof Date)?C(o[e]):o[e];return l}else return o},pt=()=>{k.insertResizeKeys.forEach(o=>{k.excludeResizeKeys.indexOf(o)===-1&&H.value.push(o)})};t.watch(()=>[k.insertResizeKeys,k.excludeResizeKeys],()=>{pt()});const H=t.ref([]);pt();const G=t.ref(null);let T=null,yt=null;const Ut=t.ref(null),q=t.ref(0),U=t.ref(null),J=t.ref(null),Q=t.ref(null),Z=t.ref(null),_=o=>{const l=C(o);if(o===null)U.value=null,J.value=null,Q.value=null,Z.value=null;else{const e=getComputedStyle(G.value),n=parseInt(e.getPropertyValue("--auxiliary-width").trim()),r=p.value.filter(a=>a.id!==l.id).map(a=>a.y),x=p.value.filter(a=>a.id!==l.id).map(a=>a.y+a.height-1),y=[...r,...x];y.sort(),y.filter(a=>a<=l.y&&l.y-k.auxiliarySpace<a||a>=l.y&&l.y+k.auxiliarySpace>a).length>0?U.value=l.y:U.value=null,y.filter(a=>a<=l.y+l.height-1&&l.y+l.height-1-k.auxiliarySpace<a||a>=l.y+l.height-1&&l.y+l.height-1+k.auxiliarySpace>a).length>0?J.value=l.y+l.height-n:J.value=null;const w=p.value.filter(a=>a.id!==l.id).map(a=>a.x),u=p.value.filter(a=>a.id!==l.id).map(a=>a.x+a.width-1),c=[...w,...u];c.sort(),c.filter(a=>a<=l.x&&l.x-k.auxiliarySpace<a||a>=l.x&&l.x+k.auxiliarySpace>a).length>0?Q.value=l.x:Q.value=null,c.filter(a=>a<=l.x+l.width-1&&l.x+l.width-1-k.auxiliarySpace<a||a>=l.x+l.width-1&&l.x+l.width-1+k.auxiliarySpace>a).length>0?Z.value=l.x+l.width-n:Z.value=null}},p=t.ref([]),Jt=(o,l)=>{let e=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector;for(;o&&!e.call(o,l);)o=o.parentElement;return o};let D=null,ft=null,ut=null;const V=t.ref({}),Qt=(o,l)=>{j(),D=l,V.value=C(p.value[D]),p.value[D].move=!0,_(p.value[D]);const e=Jt(o.target,".com-item");ft=o.clientX-e.offsetLeft,ut=o.clientY-e.offsetTop,window.addEventListener("mousemove",gt),window.addEventListener("mouseup",xt)},gt=o=>{const l=o.clientX-ft,e=o.clientY-ut,n=l<=I("left")?I("left"):l>=I("right")?I("right"):l,r=e<=I("top")?I("top"):e>=I("bottom")?I("bottom"):e,x=n-p.value[D].x,y=r-p.value[D].y,w=`${x>3?"right":x<-3?"left":""}_${y>0?"bottom":y<0?"top":""}`;p.value[D].x=n,p.value[D].y=r,_(p.value[D]);let u=C(p.value.filter(c=>c.move!==!0).filter(c=>c.x<n&&c.x+c.width>n||c.x===n||c.x>n&&c.x<n+p.value[D].width).filter(c=>c.y<r&&c.y+c.height>r||c.y===r||c.y>r&&c.y<r+p.value[D].height));if(u.length===0)V.value.x=n,V.value.y=r;else{if(w.indexOf("top")!==-1){u=u.filter(i=>i.y<V.value.y);const c=Math.min(...u.map(i=>i.y+i.height));u.forEach(i=>{Math.abs(i.y+i.height-c)<5&&(i.y=c-i.height)});let a=V.value.y-r,f=!0,s=[...u];const d=i=>{C(p.value.filter(h=>h.move!==!0&&h.y+h.height-i.y<=a+3&&h.y+h.height-i.y>=0).filter(h=>h.x<i.x&&h.x+h.width>i.x||h.x>=i.x&&h.x<i.x+i.width)).forEach(h=>{h.y+h.height!==i.y&&(h.y=i.y-h.height),s.findIndex(B=>B.id===h.id)===-1&&(s.push(h),d(h))})};if(u.forEach(i=>{d(i)}),s.sort((i,M)=>{const h=i.y,B=M.y;return h-B}),(s.length===0||s.filter(i=>i.y===0).length>0)&&(f=!1),f){let i=0;s.filter(h=>h.y===s[0].y).forEach(h=>{C(p.value.filter(m=>m.move!==!0&&m.y+m.height<h.y).filter(m=>m.x<h.x&&m.x+m.width>h.x||m.x>=h.x&&m.x<h.x+h.width)).forEach(m=>{m.y+m.height>i&&(i=m.y+m.height)})}),i=s[0].y-i,i<a&&(a=i),s.forEach(h=>{h.y-=a,p.value.filter(B=>B.id===h.id)[0].y=h.y}),V.value.x=n,V.value.y=p.value.filter(h=>h.id===s[s.length-1].id)[0].y+p.value.filter(h=>h.id===s[s.length-1].id)[0].height}else{let i=0;u.forEach(B=>{const m=p.value.filter(O=>O.move!==!0).filter(O=>O.x<B.x&&O.x+O.width>B.x||O.x===B.x||O.x>B.x&&O.x<B.x+B.width).filter(O=>O.y>B.y+B.height);m.length>0&&(i=Math.min(...m.map(O=>O.y)))});const M=i===0?0:i-V.value.height-(Math.max(...u.map(B=>B.y+B.height))-Math.min(...u.map(B=>B.y))),h=M===0?r+V.value.height-Math.min(...u.map(B=>B.y)):i-Math.min(...u.map(B=>B.y))-(Math.max(...u.map(B=>B.y+B.height))-Math.min(...u.map(B=>B.y)));if(M===0||r<=M){u.filter(m=>m.y<V.value.y).forEach(m=>{m.y+=h,p.value.filter(O=>O.id===m.id)[0].y=m.y}),V.value.x=n,V.value.y=r;const B=m=>{p.value.filter(N=>N.move!==!0&&N.id!==m.id).filter(N=>N.x<m.x&&N.x+N.width>m.x||N.x===m.x||N.x>m.x&&N.x<m.x+m.width).filter(N=>N.y<m.y&&N.y+N.height>m.y||N.y===m.y||N.y>m.y&&N.y<m.y+m.height).forEach(N=>{N.y=m.y+m.height,B(N)})};p.value.forEach(m=>B(m))}}u=C(p.value.filter(i=>i.move!==!0).filter(i=>i.x<n&&i.x+i.width>n||i.x===n||i.x>n&&i.x<n+p.value[D].width).filter(i=>i.y<r&&i.y+i.height>r||i.y===r||i.y>r&&i.y<r+p.value[D].height))}if(w.indexOf("bottom")!==-1){let c=0;u.forEach(s=>{const d=p.value.filter(i=>i.move!==!0).filter(i=>i.x<s.x&&i.x+i.width>s.x||i.x===s.x||i.x>s.x&&i.x<s.x+s.width).filter(i=>i.y+i.height<s.y);d.length>0&&(c=Math.max(...d.map(i=>i.y+i.height)))});const a=c+(Math.max(...u.map(s=>s.height+s.y))-Math.min(...u.map(s=>s.y))),f=Math.min(...u.map(s=>s.y))-c;if(r>=a){let s=!0;u.filter(i=>i.y>V.value.y).forEach(i=>{i.y-=f,p.value.filter(h=>h.id===i.id)[0].y=i.y;const M=p.value.filter(h=>h.move!==!0&&h.id!==i.id).filter(h=>h.x<i.x&&h.x+h.width>i.x||h.x===i.x||h.x>i.x&&h.x<i.x+i.width).filter(h=>h.y<i.y&&h.y+h.height>i.y||h.y===i.y||h.y>i.y&&h.y<i.y+i.height);M.length>0&&(i.y=Math.max(...M.map(h=>h.y+h.height)),p.value.filter(h=>h.id===i.id)[0].y=i.y)}),V.value.x=n,s&&(V.value.y=a);const d=i=>{p.value.filter(h=>h.id!==i.id).filter(h=>h.x<i.x&&h.x+h.width>i.x||h.x===i.x||h.x>i.x&&h.x<i.x+i.width).filter(h=>h.y<i.y&&h.y+h.height>i.y||h.y===i.y||h.y>i.y&&h.y<i.y+i.height).forEach(h=>{h.y=i.y+i.height,h.move===!0&&(V.value.y=h.y,s=!1),d(h)})};p.value.forEach(i=>d(i)),u=C(p.value.filter(i=>i.move!==!0).filter(i=>i.x<n&&i.x+i.width>n||i.x===n||i.x>n&&i.x<n+p.value[D].width).filter(i=>i.y<r&&i.y+i.height>r||i.y===r||i.y>r&&i.y<r+p.value[D].height))}}if(((w.indexOf("top")!==-1||w.indexOf("bottom")!==-1)&&(w.indexOf("right")!==-1||w.indexOf("left")!==-1)&&Math.abs(x)>8||w.indexOf("top")===-1&&w.indexOf("bottom")===-1&&(w.indexOf("right")!==-1||w.indexOf("left")!==-1))&&u.length>0){u.sort((a,f)=>{const s=a.y,d=f.y;return s-d});let c=!0;for(let a=0;a<u.length;a++){if(c){const f=C(p.value);for(let s=0;s<=a;s++){let d=null;const i=f.filter(M=>M.move!==!0&&M.y<u[s].y).filter(M=>M.x<u[s].x&&M.x+M.width>u[s].x||M.x===u[s].x||M.x>u[s].x&&M.x<u[s].x+u[s].width);if(i.length===0?d=0:d=Math.max(...i.map(M=>M.y+M.height)),s===a){if(u[s].y-(u[s].y+u[s].height-r)<d){c=!1;break}}else if(u[s].y-u[a].height<d){c=!1;break}else f.filter(M=>M.id===u[s].id)[0].y-=u[a].height}}if(c){u[a].y-=u[a].y+u[a].height-r,p.value.filter(f=>f.id===u[a].id)[0].y=u[a].y;for(let f=a;f>0;f--)u[a-1].y-=u[a].height,p.value.filter(s=>s.id===u[a-1].id)[0].y=u[a-1].y}else u.filter(f=>f.id===u[a].id).forEach(f=>{f.y+=p.value[D].y+p.value[D].height-f.y,p.value.filter(d=>d.id===f.id)[0].y=f.y;const s=d=>{p.value.filter(M=>M.move!==!0&&M.id!==d.id).filter(M=>M.x<d.x&&M.x+M.width>d.x||M.x===d.x||M.x>d.x&&M.x<d.x+d.width).filter(M=>M.y<d.y&&M.y+M.height>d.y||M.y===d.y||M.y>d.y&&M.y<d.y+d.height).forEach(M=>{M.y=d.y+d.height,s(M)})};s(f)})}V.value.x=n}}z(!1)},xt=()=>{window.removeEventListener("mousemove",gt),window.removeEventListener("mouseup",xt),delete p.value[D].move,p.value[D].x=V.value.x,p.value[D].y=V.value.y,D=null,_(null),z()},I=o=>{switch(o){case"top":return 0;case"right":return T-p.value[D].width;case"bottom":return 999999999;case"left":return 0}};let g=null,st="",et=0,lt=0,X=0,v=0,L=0,R=0,b=0,rt=0,F=0,ot=0;const Y=(o,l,e)=>{j(),g=l,st=e,et=o.clientX,lt=o.clientY,X=l.width,v=l.height,L=l.y,R=l.x,g.drag=!0,_(g);const n=p.value.filter(c=>c.static===!0&&(c.x<l.x?c.x+c.width>=l.x:c.x<=l.x+l.width)),r=p.value.filter(c=>c.static===!0&&(c.y<l.y?c.y+c.height>=l.y:c.y<=l.y+l.height)),x=n.filter(c=>c.y+c.height<=l.y).map(c=>c.y+c.height);x.length>0?b=Math.max(...x):b=0;const y=n.filter(c=>c.y>=l.y+l.height).map(c=>c.y);y.length>0?rt=Math.min(...y):rt=0;const w=r.filter(c=>c.x+c.width<=l.x).map(c=>c.x+c.width);w.length>0?F=Math.max(...w):F=0;const u=r.filter(c=>c.x>=l.x+l.width).map(c=>c.x);u.length>0?ot=Math.min(...u):ot=0,window.addEventListener("mousemove",wt),window.addEventListener("mouseup",kt)},wt=o=>{const l=X+(o.clientX-et),e=v+(o.clientY-lt),n=X-(o.clientX-et),r=v-(o.clientY-lt),x=L+(o.clientY-lt),y=R+(o.clientX-et),w=getComputedStyle(G.value),u=parseInt(w.getPropertyValue("--com-item-border-width").trim()),c=parseInt(w.getPropertyValue("--group-tit-height").trim());switch(st){case"top-left":if(g.height=r<k.itemMinHeight?k.itemMinHeight:r>S("top")?S("top"):r,g.y=r<k.itemMinHeight?L+v-k.itemMinHeight:r>S("top")?b:x,g.width=n<k.itemMinWidth?k.itemMinWidth:n>S("left")?S("left"):n,g.x=n<k.itemMinWidth?R+X-k.itemMinWidth:n>S("left")?F:y,g.isGroup===!0){const f=g.width-2*u,s=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(d=>{d.width=f*d.groupW,d.x=f*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"top":if(g.height=r<k.itemMinHeight?k.itemMinHeight:r>S("top")?S("top"):r,g.y=r<k.itemMinHeight?L+v-k.itemMinHeight:r>S("top")?b:x,g.isGroup===!0){const f=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(s=>{s.height=f*s.groupH,s.y=f*s.groupY})}break;case"top-right":if(g.height=r<k.itemMinHeight?k.itemMinHeight:r>S("top")?S("top"):r,g.y=r<k.itemMinHeight?L+v-k.itemMinHeight:r>S("top")?b:x,g.width=l<k.itemMinWidth?k.itemMinWidth:l>S("right")?S("right"):l,g.isGroup===!0){const f=g.width-2*u,s=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(d=>{d.width=f*d.groupW,d.x=f*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"left":if(g.width=n<k.itemMinWidth?k.itemMinWidth:n>S("left")?S("left"):n,g.x=n<k.itemMinWidth?R+X-k.itemMinWidth:n>S("left")?F:y,g.isGroup===!0){const f=g.width-2*u;g.groupData.forEach(s=>{s.width=f*s.groupW,s.x=f*s.groupX})}break;case"right":if(g.width=l<k.itemMinWidth?k.itemMinWidth:l>S("right")?S("right"):l,g.isGroup===!0){const f=g.width-2*u;g.groupData.forEach(s=>{s.width=f*s.groupW,s.x=f*s.groupX})}break;case"bottom-left":if(g.height=e<k.itemMinHeight?k.itemMinHeight:e>S("bottom")?S("bottom"):e,g.width=n<k.itemMinWidth?k.itemMinWidth:n>S("left")?S("left"):n,g.x=n<k.itemMinWidth?R+X-k.itemMinWidth:n>S("left")?F:y,g.isGroup===!0){const f=g.width-2*u,s=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(d=>{d.width=f*d.groupW,d.x=f*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break;case"bottom":if(g.height=e<k.itemMinHeight?k.itemMinHeight:e>S("bottom")?S("bottom"):e,g.isGroup===!0){const f=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(s=>{s.height=f*s.groupH,s.y=f*s.groupY})}break;case"bottom-right":if(g.height=e<k.itemMinHeight?k.itemMinHeight:e>S("bottom")?S("bottom"):e,g.width=l<k.itemMinWidth?k.itemMinWidth:l>S("right")?S("right"):l,g.isGroup===!0){const f=g.width-2*u,s=g.height-2*u-(g.groupTit?c:0);g.groupData.forEach(d=>{d.width=f*d.groupW,d.x=f*d.groupX,d.height=s*d.groupH,d.y=s*d.groupY})}break}_(g);let a=C(p.value.filter(f=>f.drag!==!0).filter(f=>f.x<g.x&&f.x+f.width>g.x||f.x===g.x||f.x>g.x&&f.x<g.x+g.width).filter(f=>f.y<g.y&&f.y+f.height>g.y||f.y===g.y||f.y>g.y&&f.y<g.y+g.height));if(a.length>0){a.sort((f,s)=>{const d=f.y,i=s.y;return d-i});for(let f=0;f<a.length;f++)a.filter(s=>s.id===a[f].id).forEach(s=>{s.y+=g.y+g.height-s.y,p.value.filter(i=>i.id===s.id)[0].y=s.y;const d=i=>{p.value.filter(h=>h.drag!==!0&&h.id!==i.id).filter(h=>h.x<i.x&&h.x+h.width>i.x||h.x===i.x||h.x>i.x&&h.x<i.x+i.width).filter(h=>h.y<i.y&&h.y+h.height>i.y||h.y===i.y||h.y>i.y&&h.y<i.y+i.height).forEach(h=>{h.y=i.y+i.height,d(h)})};d(s)})}z(!1)},kt=o=>{delete g.drag,st="",g=null,_(null),window.removeEventListener("mousemove",wt),window.removeEventListener("mouseup",kt),z()},S=o=>{switch(o){case"top":return L+v-b;case"left":return R+X-F;case"right":return(ot>0?ot:T)-R;case"bottom":return rt>0?rt-L:999999999}},z=(o=!0)=>{o===!0&&Mt();const l=p.value.map(e=>e.y+e.height);l.length>0?q.value=Math.max(...l):q.value=0};t.watch(()=>k.ySpace,()=>{k.ySpace>=0&&Mt()});const Mt=()=>{const o=C(p.value).sort((l,e)=>{const n=l.y,r=e.y;return n-r});for(let l=0;l<o.length;l++){if(l===0&&o[l].y>0){const e=o[l].y;for(let n=l;n<o.length;n++)o[n].y-=e,p.value.filter(r=>r.id===o[n].id)[0].y=o[n].y}if(l<o.length-1&&o[l+1].y>o[l].y+o[l].height){const e=C(o.slice(0,l+1));if(o[l+1].y>Math.max(...e.map(n=>n.y+n.height))){const n=o[l+1].y-Math.max(...e.map(r=>r.y+r.height));for(let r=l+1;r<o.length;r++)o[r].y-=n,p.value.filter(x=>x.id===o[r].id)[0].y=o[r].y}}}for(let l=0;l<o.length-1;l++){let e=o.findIndex(n=>n.y===o[l].y+o[l].height);if(e!==-1)for(let n=e;n<o.length;n++)o[n].y+=k.ySpace,p.value.filter(r=>r.id===o[n].id)[0].y=o[n].y}k.addFirstSpace&&p.value.forEach(l=>l.y+=k.ySpace)};t.onMounted(()=>{mt.observe(G.value)});const mt=new ResizeObserver(o=>{ee(T===o[0].contentRect.width?null:o[0].contentRect.width,yt===o[0].contentRect.height?null:o[0].contentRect.height)});let ct=!1;const Zt=(o=[],l=null)=>{p.value=C(o),p.value.filter(e=>e.isGroup===!0).forEach(e=>{if(e.isGroup===!0)if(e.groupData.length<2)tt(e.id);else{const n=at(e.groupData,e);nt(n)}}),l!==null?t.nextTick(()=>{const n=G.value.getBoundingClientRect().width/l,r=getComputedStyle(G.value),x=parseInt(r.getPropertyValue("--com-item-border-width").trim()),y=parseInt(r.getPropertyValue("--group-tit-height").trim());p.value.forEach(w=>{if(w.width*=n,w.height*=n,w.x*=n,w.y*=n,w.isGroup===!0){const u=w.width-2*x,c=w.height-2*x-(w.groupTit?y:0);w.groupData.forEach(a=>{a.width=u*a.groupW,a.x=u*a.groupX,a.height=c*a.groupH,a.y=c*a.groupY})}}),z()}):z(),ct=!0,setTimeout(()=>{ct=!1},500)},jt=(o,l)=>{l.showSet=!0},te=(o,l)=>{delete l.showSet},Et=(o,l,e)=>{const n=l.map(y=>y.y),r=Math.max(...n),x=l.filter(y=>y.y+y.height>r);x.sort((y,w)=>{const u=y.x,c=w.x;return u-c});for(let y=0;y<x.length;y++){if(y===0&&x[y].x>=o.width){o.y=r,o.x=0;break}if(x.length>1&&y!==x.length-1&&x[y].x+x[y].width+o.width<=x[y+1].x){o.y=r,o.x=x[y].x+x[y].width;break}if(y===x.length-1&&x[y].x+x[y].width+o.width<=e){o.y=r,o.x=x[y].x+x[y].width;break}}if(o.y==null){o.x=0;const y=l.map(w=>w.y+w.height);o.y=Math.max(...y)}},it=(o,l=null,e=!1)=>{const n=C(o),r=p.value.filter(x=>x.id===l);if(n.id||(n.id=new Date().getTime()+""),l&&r.length!==1){try{}catch{}return}if(e!==!0)if(delete n.x,delete n.y,l){const x=getComputedStyle(G.value),y=parseInt(x.getPropertyValue("--com-item-border-width").trim());Et(n,r[0].groupData,r[0].width-2*y)}else p.value.length===0?(n.x=0,n.y=0):Et(n,p.value,T);if(l){r[0].groupData.push(n);const x=at(r[0].groupData,r[0]);nt(x);const y=w=>{p.value.filter(c=>c.id!==w.id).filter(c=>c.x<w.x&&c.x+c.width>w.x||c.x===w.x||c.x>w.x&&c.x<w.x+w.width).filter(c=>c.y<w.y&&c.y+c.height>w.y||c.y===w.y||c.y>w.y&&c.y<w.y+w.height).forEach(c=>{c.y=w.y+w.height,y(c)})};y(x)}else p.value.push(n);z()},K=(o,l=null)=>{let e=-1;const n=p.value.filter(r=>r.id===l);if(l?n.length===1&&(e=n[0].groupData.findIndex(r=>r.id===o)):e=p.value.findIndex(r=>r.id===o),e!==-1){if(l)if(n[0].groupData.splice(e,1),n[0].groupData.length===1)tt(l);else{const r=at(n[0].groupData,n[0]);nt(r)}else p.value.splice(e,1);z()}else try{}catch{}},nt=o=>{if(o.id){const l=C(o);delete l.showPop,delete l.showSet,l.groupData&&l.groupData.forEach(r=>{delete r.showPop,delete r.showSet});let e=-1;const n=p.value.filter(r=>r.id===l.inGroupId);if(l.inGroupId?n.length===1&&(e=n[0].groupData.findIndex(r=>r.id===l.id)):e=p.value.findIndex(r=>r.id===l.id),e!==-1)l.inGroupId?n[0].groupData[e]=l:p.value[e]=l,z();else try{}catch{}}else try{}catch{}},ee=(o,l)=>{if(o!==null){const e=T?o/T:1;T=o;const n=getComputedStyle(G.value),r=parseInt(n.getPropertyValue("--com-item-border-width").trim()),x=parseInt(n.getPropertyValue("--group-tit-height").trim());ct||(p.value.forEach(y=>{if(y.width*=e,y.height*=e,y.x*=e,y.y*=e,y.isGroup===!0){const w=y.width-2*r,u=y.height-2*r-(y.groupTit?x:0);y.groupData.forEach(c=>{c.width=w*c.groupW,c.x=w*c.groupX,c.height=u*c.groupH,c.y=u*c.groupY})}}),z())}l!==null&&(yt=l)},Bt=o=>{o.showPop||(p.value.forEach(l=>{delete l.showPop,l.groupData&&l.groupData.forEach(e=>{delete e.showPop})}),o.showPop=!0,window.addEventListener("click",j))},j=()=>{p.value.forEach(o=>{delete o.showPop,o.groupData&&o.groupData.forEach(l=>{delete l.showPop})}),window.removeEventListener("click",j)},P=t.ref(!1),St=o=>{const l=p.value.findIndex(e=>e.id===o);if(l!==-1)p.value[l].checked=!0,p.value[l].disabled=!0,P.value=!0,A("showGroup",P.value);else try{}catch{}},Dt=()=>{P.value=!1,p.value.forEach(o=>{delete o.checked,delete o.disabled,o.groupData&&o.groupData.forEach(l=>{delete l.checked,delete l.disabled})}),A("showGroup",P.value)},le=o=>{o.checked=!o.checked,A("updateChecked",p.value.filter(l=>l.checked).length)},at=(o,l)=>{const e=C(o),n=C(l);e.sort((a,f)=>{const s=a.x,d=f.x;return s-d});for(let a=0;a<e.length-1;a++){if(a===0&&e[a].x>0){const f=e[a].x;for(let s=a;s<e.length;s++)e[s].x-=f}if(e[a+1].x>e[a].x+e[a].width){const f=C(e.slice(0,a+1));if(e[a+1].x>Math.max(...f.map(s=>s.x+s.width))){const s=e[a+1].x-Math.max(...f.map(d=>d.x+d.width));for(let d=a+1;d<e.length;d++)e[d].x-=s}}}e.sort((a,f)=>{const s=a.y,d=f.y;return s-d});for(let a=0;a<e.length-1;a++){if(a===0&&e[a].y>0){const f=e[a].y;for(let s=a;s<e.length;s++)e[s].y-=f}if(e[a+1].y>e[a].y+e[a].height){const f=C(e.slice(0,a+1));if(e[a+1].y>Math.max(...f.map(s=>s.y+s.height))){const s=e[a+1].y-Math.max(...f.map(d=>d.y+d.height));for(let d=a+1;d<e.length;d++)e[d].y-=s}}}const r=e.map(a=>a.x+a.width),x=Math.max(...r),y=e.map(a=>a.y+a.height),w=Math.max(...y);e.forEach(a=>{a.inGroupId||(a.inGroupId=n.id),a.groupW=a.width/x,a.groupH=a.height/w,a.groupX=a.x/x,a.groupY=a.y/w,a.isObstacle=a.x+a.width===x&&a.y===0});const u=getComputedStyle(G.value),c=parseInt(u.getPropertyValue("--com-item-border-width").trim());return n.width=x+2*c,n.height=w+2*c,n.groupData=[...e],n},re=()=>{t.nextTick(()=>{const o=getComputedStyle(G.value),l=parseInt(o.getPropertyValue("--com-item-border-width").trim()),e=parseInt(o.getPropertyValue("--group-tit-height").trim());p.value.filter(n=>n.isGroup===!0).forEach(n=>{const r=n.width-2*l,x=n.height-2*l-(n.groupTit?e:0);n.groupData.forEach(y=>{y.width=r*y.groupW,y.x=r*y.groupX,y.height=x*y.groupH,y.y=x*y.groupY})})})},oe=()=>{const o=p.value.filter(l=>l.checked);if(o.length>1){const l={id:new Date().getTime()+"G",isGroup:!0,groupTit:""},e=at(o,l);e.groupData.forEach(n=>{K(n.id)}),it(e),z()}Dt()},Ct=(o,l)=>{const e=p.value.filter(n=>n.id===l)[0];if(e){const n=e.groupData.filter(r=>r.id===o)[0];if(n)e.groupData.length===2?tt(l):(delete n.inGroupId,delete n.groupW,delete n.groupH,delete n.groupX,delete n.groupY,delete n.isObstacle,K(n.id,e.id),it(n),z());else try{}catch{}}else try{}catch{}},tt=o=>{const l=p.value.filter(e=>e.id===o)[0];if(l)l.groupData.forEach(e=>{delete e.inGroupId,delete e.groupW,delete e.groupH,delete l.groupX,delete l.groupY,delete l.isObstacle,e.x+=l.x,e.y+=l.y,it(e,null,!0)}),K(l.id),z();else try{}catch{}},ie=(o="",l)=>{const e=p.value.filter(n=>n.id===l)[0];if(e){if(!e.groupTit||!o){const r=getComputedStyle(G.value),x=parseInt(r.getPropertyValue("--group-tit-height").trim());e.groupTit&&!o&&(e.height-=x),!e.groupTit&&o&&(e.height+=x)}e.groupTit=o;const n=r=>{p.value.filter(y=>y.id!==r.id).filter(y=>y.x<r.x&&y.x+y.width>r.x||y.x===r.x||y.x>r.x&&y.x<r.x+r.width).filter(y=>y.y<r.y&&y.y+y.height>r.y||y.y===r.y||y.y>r.y&&y.y<r.y+r.height).forEach(y=>{y.y=r.y+r.height,n(y)})};n(e),z()}else try{}catch{}},ne=()=>(p.value.forEach(o=>{delete o.showPop,delete o.showSet,o.groupData&&o.groupData.forEach(l=>{delete l.showPop,delete l.showSet})}),{data:C(p.value),width:T});return t.onBeforeUnmount(()=>{mt.unobserve(G.value),window.removeEventListener("click",j)}),W({init:Zt,addItem:it,deleteItem:K,updateItem:nt,openGroup:St,closeGroup:Dt,changeGroupBorder:re,addGroup:oe,removeGroupItem:Ct,removeGroup:tt,changeGroupTit:ie,getData:ne}),(o,l)=>(t.openBlock(),t.createElementBlock("div",{class:"vue-drag-component-plus",ref_key:"pageRef",ref:G},[t.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:Ut},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(p),(e,n)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item",E.seeModel||t.unref(P)||e.static===!0||e.dragable===!1?"":"can-drag",e.move?"is-move":"",e.drag?"is-drag":"",e.showPop?"on-top":"",E.seeModel?"no-hover":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:n,onMousedown:t.withModifiers(r=>E.seeModel||t.unref(P)||e.static===!0||e.dragable===!1?null:Qt(r,n),["prevent"]),onMouseenter:r=>E.seeModel||t.unref(P)||t.unref(D)||t.unref(g)||!e.isGroup?null:jt(r,e),onMouseleave:r=>E.seeModel||t.unref(P)||t.unref(D)||t.unref(g)||!e.isGroup?null:te(r,e)},[t.createElementVNode("div",Nt,[e.isGroup?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[e.groupTit?(t.openBlock(),t.createElementBlock("div",{key:0,class:"group-item-tit",title:e.groupTit},t.toDisplayString(e.groupTit),9,Ot)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:t.normalizeClass(["group-item-content",e.groupTit?"":"full"])},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.groupData,(r,x)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item-box-child",r.isObstacle?"else":""]),style:t.normalizeStyle({width:r.width+"px",height:r.height+"px",top:r.y+"px",left:r.x+"px"}),key:x},[t.createElementVNode("div",zt,[t.renderSlot(o.$slots,"item",{data:r},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(r.width*100)/100)+","+t.toDisplayString(Math.round(r.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(r.x*100)/100)+","+t.toDisplayString(Math.round(r.y*100)/100),1)])]),!E.seeModel&&!t.unref(P)&&t.unref(D)===null&&t.unref(g)===null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box",style:t.normalizeStyle({display:r.showPop?"flex":"none"}),onMousedown:t.withModifiers(y=>null,["prevent","stop"])},[t.createVNode($,{iconObj:E.settingIcon,onClick:t.withModifiers(y=>Bt(r),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),r.showPop?(t.openBlock(),t.createElementBlock("div",{key:1,class:"setting-box-pop",onMousedown:t.withModifiers(y=>null,["prevent","stop"])},[t.renderSlot(o.$slots,"setPopNormal",{data:C(r)},()=>[t.createElementVNode("div",{class:"setting-box-pop-item",onClick:y=>Ct(r.id,r.inGroupId)},"移出组合",8,Gt),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:y=>K(r.id,r.inGroupId)},"删除",8,Pt)])],32)):t.createCommentVNode("",!0)],6))),128))],2)],64)):(t.openBlock(),t.createElementBlock("div",Wt,[t.renderSlot(o.$slots,"item",{data:e},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(e.width*100)/100)+","+t.toDisplayString(Math.round(e.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(e.x*100)/100)+","+t.toDisplayString(Math.round(e.y*100)/100),1)])])),!e.isGroup&&e.notGroup!==!0&&t.unref(P)?(t.openBlock(),t.createElementBlock("div",{key:2,class:t.normalizeClass(["group-checkbox",e.checked?"is-checked":"",e.disabled?"disabled":""]),onClick:r=>e.disabled?null:le(e)},null,10,Ht)):t.createCommentVNode("",!0),!E.seeModel&&!t.unref(P)&&t.unref(D)===null&&t.unref(g)===null?(t.openBlock(),t.createElementBlock("div",{key:3,class:t.normalizeClass(["setting-box",e.isGroup===!0?"only-g":""]),style:t.normalizeStyle({display:e.showPop||e.showSet?"flex":"none"}),onMousedown:t.withModifiers(r=>null,["prevent","stop"])},[t.createVNode($,{iconObj:E.settingIcon,onClick:t.withModifiers(r=>Bt(e),["prevent","stop"])},null,8,["iconObj","onClick"])],38)):t.createCommentVNode("",!0),e.showPop?(t.openBlock(),t.createElementBlock("div",{key:4,class:t.normalizeClass(["setting-box-pop",e.isGroup===!0?"special":""]),onMousedown:t.withModifiers(r=>null,["prevent","stop"])},[e.isGroup===!0?t.renderSlot(o.$slots,"setPopSpecial",{key:0,data:C(e)},()=>[E.hideTit?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:r=>A("showTitPop",e.groupTit,e.id)}," 设置组合标题",8,Tt)),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:r=>tt(e.id)},"解除组合",8,It)]):t.renderSlot(o.$slots,"setPopNormal",{key:1,data:C(e)},()=>[e.notGroup!==!0?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:r=>St(e.id)},"组合",8,Yt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:r=>K(e.id)},"删除",8,Xt)])],34)):t.createCommentVNode("",!0)]),!E.seeModel&&!t.unref(P)&&!e.move&&e.static!==!0&&e.resizable!==!1?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.unref(H).indexOf("topLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:0,class:"resize-line top-left",onMousedown:t.withModifiers(r=>Y(r,e,"top-left"),["prevent","stop"])},null,40,vt)):t.createCommentVNode("",!0),t.unref(H).indexOf("top")!==-1?(t.openBlock(),t.createElementBlock("div",{key:1,class:"resize-line top",onMousedown:t.withModifiers(r=>Y(r,e,"top"),["prevent","stop"])},null,40,Lt)):t.createCommentVNode("",!0),t.unref(H).indexOf("topRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:2,class:"resize-line top-right",onMousedown:t.withModifiers(r=>Y(r,e,"top-right"),["prevent","stop"])},null,40,Rt)):t.createCommentVNode("",!0),t.unref(H).indexOf("left")!==-1?(t.openBlock(),t.createElementBlock("div",{key:3,class:"resize-line left",onMousedown:t.withModifiers(r=>Y(r,e,"left"),["prevent","stop"])},null,40,$t)):t.createCommentVNode("",!0),t.unref(H).indexOf("right")!==-1?(t.openBlock(),t.createElementBlock("div",{key:4,class:"resize-line right",onMousedown:t.withModifiers(r=>Y(r,e,"right"),["prevent","stop"])},null,40,At)):t.createCommentVNode("",!0),t.unref(H).indexOf("bottomLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:5,class:"resize-line bottom-left",onMousedown:t.withModifiers(r=>Y(r,e,"bottom-left"),["prevent","stop"])},null,40,_t)):t.createCommentVNode("",!0),t.unref(H).indexOf("bottom")!==-1?(t.openBlock(),t.createElementBlock("div",{key:6,class:"resize-line bottom",onMousedown:t.withModifiers(r=>Y(r,e,"bottom"),["prevent","stop"])},null,40,bt)):t.createCommentVNode("",!0),t.unref(H).indexOf("bottomRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:7,class:"resize-line bottom-right",onMousedown:t.withModifiers(r=>Y(r,e,"bottom-right"),["prevent","stop"])},null,40,Ft)):t.createCommentVNode("",!0)],64)):t.createCommentVNode("",!0)],46,Vt))),128)),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(p),(e,n)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["shadow-bg",e.move?"is-move":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:n},null,6))),128)),t.unref(D)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"drag-bg",style:t.normalizeStyle({width:t.unref(V).width+"px",height:t.unref(V).height+"px",top:t.unref(V).y+"px",left:t.unref(V).x+"px"})},null,4)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"height-bg",style:t.normalizeStyle({height:(t.unref(q)>0?+(t.unref(q)+(E.seeModel?E.seeModelMinBg:220)):t.unref(q))+"px"})},null,4),E.hideAuxiliary?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock(t.Fragment,{key:1},[t.unref(U)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"auxiliary-line hor",style:t.normalizeStyle({top:t.unref(U)+"px",left:"0px"})},null,4)):t.createCommentVNode("",!0),t.unref(J)!==null?(t.openBlock(),t.createElementBlock("div",{key:1,class:"auxiliary-line hor",style:t.normalizeStyle({top:t.unref(J)+"px",left:"0px"})},null,4)):t.createCommentVNode("",!0),t.unref(Q)!==null?(t.openBlock(),t.createElementBlock("div",{key:2,class:"auxiliary-line",style:t.normalizeStyle({top:"0px",left:t.unref(Q)+"px"})},null,4)):t.createCommentVNode("",!0),t.unref(Z)!==null?(t.openBlock(),t.createElementBlock("div",{key:3,class:"auxiliary-line",style:t.normalizeStyle({top:"0px",left:t.unref(Z)+"px"})},null,4)):t.createCommentVNode("",!0)],64)),t.unref(p).length===0?(t.openBlock(),t.createElementBlock("div",Kt,[t.renderSlot(o.$slots,"empty",{},()=>[l[0]||(l[0]=t.createTextVNode(" 暂无数据 "))])])):t.createCommentVNode("",!0)],512)],512))}}],ht={install(E){qt.forEach(W=>{E.component("vueDragComponentPlus",W)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(ht),ht});
