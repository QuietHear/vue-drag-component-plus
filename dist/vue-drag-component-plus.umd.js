(function(t,L){typeof exports=="object"&&typeof module<"u"?module.exports=L(require("vue")):typeof define=="function"&&define.amd?define(["vue"],L):(t=typeof globalThis<"u"?globalThis:t||self,t.vueDragComponentPlus=L(t.Vue))})(this,function(t){"use strict";const L={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(E){return(P,it)=>{const R=t.resolveComponent("el-icon");return E.iconObj.type==="custom"?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(E.iconObj.icon),t.normalizeProps(t.mergeProps({key:0},E.iconObj.attrs)),null,16)):E.iconObj.type==="el"?(t.openBlock(),t.createBlock(R,t.normalizeProps(t.mergeProps({key:1},E.iconObj.attrs)),{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(E.iconObj.icon)))]),_:1},16)):E.iconObj.type==="iconfont"?(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:2,class:["icon iconfont","icon-"+E.iconObj.icon]},E.iconObj.attrs),null,16)):(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:3,class:E.iconObj.type},E.iconObj.attrs),t.toDisplayString(E.iconObj.icon),17))}}},jt="",Et=["onMousedown"],mt={class:"com-item-box"},Bt=["title"],Dt={class:"com-item-box-content"},Ct=["onClick"],Ot=["onClick"],Vt={key:1,class:"com-item-box-content"},St=["onClick"],vt=["onClick"],Gt=["onClick"],Nt=["onClick"],zt=["onClick"],Pt=["onMousedown"],Ht=["onMousedown"],Wt=["onMousedown"],Tt=["onMousedown"],It=["onMousedown"],Yt=["onMousedown"],Xt=["onMousedown"],bt=["onMousedown"],Lt={key:1,class:"com-empty"},Rt=[{__name:"index",props:{insertResizeKeys:{type:Array,default:()=>["topLeft","top","topRight","left","right","bottomLeft","bottom","bottomRight"]},excludeResizeKeys:{type:Array,default:()=>[]},seeModel:{type:Boolean,default:!1},seeModelMinBg:{type:Number,default:50,validator(E,P){return E>=0}},itemMinWidth:{type:Number,default:15,validator(E,P){return E>=15}},itemMinHeight:{type:Number,default:15,validator(E,P){return E>=15}},ySpace:{type:Number,default:7,validator(E,P){return E>=0}},settingIcon:{type:Object,default:()=>({icon:"设置"})},hideTit:{type:Boolean,default:!1}},emits:["showGroup","updateChecked","showTitPop"],setup(E,{expose:P,emit:it}){const R=it,k=E,C=r=>{let l=r instanceof Array?[]:{};for(let e in r)l[e]=typeof r[e]=="object"?C(r[e]):r[e];return l},nt=()=>{k.insertResizeKeys.forEach(r=>{k.excludeResizeKeys.indexOf(r)===-1&&z.value.push(r)})};t.watch(()=>[k.insertResizeKeys,k.excludeResizeKeys],()=>{nt()});const z=t.ref([]);nt();const G=t.ref(null);let H=null,st=null;const _t=t.ref(null),K=t.ref(0),g=t.ref([]),$t=(r,l)=>{let e=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;for(;r&&!e.call(r,l);)r=r.parentElement;return r};let B=null,at=null,ct=null;const O=t.ref({}),At=(r,l)=>{F(),B=l,O.value=C(g.value[B]),g.value[B].move=!0;const e=$t(r.target,".com-item");at=r.clientX-e.offsetLeft,ct=r.clientY-e.offsetTop,window.addEventListener("mousemove",ht),window.addEventListener("mouseup",dt)},ht=r=>{const l=r.clientX-at,e=r.clientY-ct,i=l<=W("left")?W("left"):l>=W("right")?W("right"):l,o=e<=W("top")?W("top"):e>=W("bottom")?W("bottom"):e,x=i-g.value[B].x,d=o-g.value[B].y,M=`${x>0?"right":x<0?"left":""}_${d>0?"bottom":d<0?"top":""}`;g.value[B].x=i,g.value[B].y=o;let y=C(g.value.filter(p=>p.move!==!0).filter(p=>p.x<i&&p.x+p.width>i||p.x===i||p.x>i&&p.x<i+g.value[B].width).filter(p=>p.y<o&&p.y+p.height>o||p.y===o||p.y>o&&p.y<o+g.value[B].height));if(y.length===0)O.value.x=i,O.value.y=o;else{if(M.indexOf("top")!==-1){y=y.filter(h=>h.y<O.value.y);const p=Math.min(...y.map(h=>h.y+h.height));y.forEach(h=>{Math.abs(h.y+h.height-p)<5&&(h.y=p-h.height)});let c=O.value.y-o,n=!0,a=[...y];const s=h=>{C(g.value.filter(f=>f.move!==!0&&f.y+f.height-h.y<=c+3&&f.y+f.height-h.y>=0).filter(f=>f.x<h.x&&f.x+f.width>h.x||f.x>=h.x&&f.x<h.x+h.width)).forEach(f=>{f.y+f.height!==h.y&&(f.y=h.y-f.height),a.findIndex(D=>D.id===f.id)===-1&&(a.push(f),s(f))})};if(y.forEach(h=>{s(h)}),a.sort((h,w)=>{const f=h.y,D=w.y;return f-D}),(a.length===0||a.filter(h=>h.y===0).length>0)&&(n=!1),n){let h=0;a.filter(f=>f.y===a[0].y).forEach(f=>{C(g.value.filter(S=>S.move!==!0&&S.y+S.height<f.y).filter(S=>S.x<f.x&&S.x+S.width>f.x||S.x>=f.x&&S.x<f.x+f.width)).forEach(S=>{S.y+S.height>h&&(h=S.y+S.height)})}),h=a[0].y-h,h<c&&(c=h),a.forEach(f=>{f.y-=c,g.value.filter(D=>D.id===f.id)[0].y=f.y}),O.value.x=i,O.value.y=g.value.filter(f=>f.id===a[a.length-1].id)[0].y+g.value.filter(f=>f.id===a[a.length-1].id)[0].height}else{const h=Math.min(...y.map(w=>w.y));h-o>=-7&&h-o<7&&(y.filter(w=>w.y<O.value.y).forEach(w=>{w.y+=g.value[B].height,g.value.filter(D=>D.id===w.id)[0].y=w.y;const f=D=>{g.value.filter(V=>V.move!==!0&&V.id!==D.id).filter(V=>V.x<D.x&&V.x+V.width>D.x||V.x===D.x||V.x>D.x&&V.x<D.x+D.width).filter(V=>V.y<D.y&&V.y+V.height>D.y||V.y===D.y||V.y>D.y&&V.y<D.y+D.height).forEach(V=>{V.y=D.y+D.height,f(V)})};f(w)}),O.value.x=i,O.value.y=h)}y=C(g.value.filter(h=>h.move!==!0).filter(h=>h.x<i&&h.x+h.width>i||h.x===i||h.x>i&&h.x<i+g.value[B].width).filter(h=>h.y<o&&h.y+h.height>o||h.y===o||h.y>o&&h.y<o+g.value[B].height))}if(M.indexOf("bottom")!==-1){const p=Math.max(...y.map(c=>c.y+c.height));if(p-(o+g.value[B].height)>=-7&&p-(o+g.value[B].height)<7){let c=!0;y.filter(n=>n.y>O.value.y).forEach(n=>{n.y-=g.value[B].height,g.value.filter(s=>s.id===n.id)[0].y=n.y;const a=g.value.filter(s=>s.move!==!0&&s.id!==n.id).filter(s=>s.x<n.x&&s.x+s.width>n.x||s.x===n.x||s.x>n.x&&s.x<n.x+n.width).filter(s=>s.y<n.y&&s.y+s.height>n.y||s.y===n.y||s.y>n.y&&s.y<n.y+n.height);if(a.length>0){n.y=Math.max(...a.map(h=>h.y+h.height)),g.value.filter(h=>h.id===n.id)[0].y=n.y;const s=h=>{g.value.filter(f=>f.id!==h.id).filter(f=>f.x<h.x&&f.x+f.width>h.x||f.x===h.x||f.x>h.x&&f.x<h.x+h.width).filter(f=>f.y<h.y&&f.y+f.height>h.y||f.y===h.y||f.y>h.y&&f.y<h.y+h.height).forEach(f=>{f.y=h.y+h.height,f.move===!0&&(O.value.y=f.y,c=!1),s(f)})};s(n)}}),O.value.x=i,c&&(O.value.y=p-g.value[B].height),y=C(g.value.filter(n=>n.move!==!0).filter(n=>n.x<i&&n.x+n.width>i||n.x===i||n.x>i&&n.x<i+g.value[B].width).filter(n=>n.y<o&&n.y+n.height>o||n.y===o||n.y>o&&n.y<o+g.value[B].height))}}if(((M.indexOf("top")!==-1||M.indexOf("bottom")!==-1)&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1)&&Math.abs(x)>8||M.indexOf("top")===-1&&M.indexOf("bottom")===-1&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1))&&y.length>0){y.sort((c,n)=>{const a=c.y,s=n.y;return a-s});let p=!0;for(let c=0;c<y.length;c++){if(p){const n=C(g.value);for(let a=0;a<=c;a++){let s=null;const h=n.filter(w=>w.move!==!0&&w.y<y[a].y).filter(w=>w.x<y[a].x&&w.x+w.width>y[a].x||w.x===y[a].x||w.x>y[a].x&&w.x<y[a].x+y[a].width);if(h.length===0?s=0:s=Math.max(...h.map(w=>w.y+w.height)),a===c){if(y[a].y-(y[a].y+y[a].height-o)<s){p=!1;break}}else if(y[a].y-y[c].height<s){p=!1;break}else n.filter(w=>w.id===y[a].id)[0].y-=y[c].height}}if(p){y[c].y-=y[c].y+y[c].height-o,g.value.filter(n=>n.id===y[c].id)[0].y=y[c].y;for(let n=c;n>0;n--)y[c-1].y-=y[c].height,g.value.filter(a=>a.id===y[c-1].id)[0].y=y[c-1].y}else y.filter(n=>n.id===y[c].id).forEach(n=>{n.y+=g.value[B].y+g.value[B].height-n.y,g.value.filter(s=>s.id===n.id)[0].y=n.y;const a=s=>{g.value.filter(w=>w.move!==!0&&w.id!==s.id).filter(w=>w.x<s.x&&w.x+w.width>s.x||w.x===s.x||w.x>s.x&&w.x<s.x+s.width).filter(w=>w.y<s.y&&w.y+w.height>s.y||w.y===s.y||w.y>s.y&&w.y<s.y+s.height).forEach(w=>{w.y=s.y+s.height,a(w)})};a(n)})}O.value.x=i}}v(!1)},dt=()=>{window.removeEventListener("mousemove",ht),window.removeEventListener("mouseup",dt),delete g.value[B].move,g.value[B].x=O.value.x,g.value[B].y=O.value.y,B=null,v()},W=r=>{switch(r){case"top":return 0;case"right":return H-g.value[B].width;case"bottom":return 999999999;case"left":return 0}};let u=null,ot="",U=0,J=0,I=0,Y=0,X=0,b=0,_=0,Q=0,$=0,Z=0;const T=(r,l,e)=>{F(),u=l,ot=e,U=r.clientX,J=r.clientY,I=l.width,Y=l.height,X=l.y,b=l.x,u.drag=!0;const i=g.value.filter(p=>p.static===!0&&(p.x<l.x?p.x+p.width>=l.x:p.x<=l.x+l.width)),o=g.value.filter(p=>p.static===!0&&(p.y<l.y?p.y+p.height>=l.y:p.y<=l.y+l.height)),x=i.filter(p=>p.y+p.height<=l.y).map(p=>p.y+p.height);x.length>0?_=Math.max(...x):_=0;const d=i.filter(p=>p.y>=l.y+l.height).map(p=>p.y);d.length>0?Q=Math.min(...d):Q=0;const M=o.filter(p=>p.x+p.width<=l.x).map(p=>p.x+p.width);M.length>0?$=Math.max(...M):$=0;const y=o.filter(p=>p.x>=l.x+l.width).map(p=>p.x);y.length>0?Z=Math.min(...y):Z=0,window.addEventListener("mousemove",pt),window.addEventListener("mouseup",gt)},pt=r=>{const l=I+(r.clientX-U),e=Y+(r.clientY-J),i=I-(r.clientX-U),o=Y-(r.clientY-J),x=X+(r.clientY-J),d=b+(r.clientX-U),M=getComputedStyle(G.value),y=parseInt(M.getPropertyValue("--com-item-border-width").trim()),p=parseInt(M.getPropertyValue("--group-tit-height").trim());switch(ot){case"top-left":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?X+Y-k.itemMinHeight:o>m("top")?_:x,u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("left")?m("left"):i,u.x=i<k.itemMinWidth?b+I-k.itemMinWidth:i>m("left")?$:d,u.isGroup===!0){const n=u.width-2*y,a=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.width=n*s.groupW,s.x=n*s.groupX,s.height=a*s.groupH,s.y=a*s.groupY})}break;case"top":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?X+Y-k.itemMinHeight:o>m("top")?_:x,u.isGroup===!0){const n=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(a=>{a.height=n*a.groupH,a.y=n*a.groupY})}break;case"top-right":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?X+Y-k.itemMinHeight:o>m("top")?_:x,u.width=l<k.itemMinWidth?k.itemMinWidth:l>m("right")?m("right"):l,u.isGroup===!0){const n=u.width-2*y,a=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.width=n*s.groupW,s.x=n*s.groupX,s.height=a*s.groupH,s.y=a*s.groupY})}break;case"left":if(u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("left")?m("left"):i,u.x=i<k.itemMinWidth?b+I-k.itemMinWidth:i>m("left")?$:d,u.isGroup===!0){const n=u.width-2*y;u.groupData.forEach(a=>{a.width=n*a.groupW,a.x=n*a.groupX})}break;case"right":if(u.width=l<k.itemMinWidth?k.itemMinWidth:l>m("right")?m("right"):l,u.isGroup===!0){const n=u.width-2*y;u.groupData.forEach(a=>{a.width=n*a.groupW,a.x=n*a.groupX})}break;case"bottom-left":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("left")?m("left"):i,u.x=i<k.itemMinWidth?b+I-k.itemMinWidth:i>m("left")?$:d,u.isGroup===!0){const n=u.width-2*y,a=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.width=n*s.groupW,s.x=n*s.groupX,s.height=a*s.groupH,s.y=a*s.groupY})}break;case"bottom":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.isGroup===!0){const n=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(a=>{a.height=n*a.groupH,a.y=n*a.groupY})}break;case"bottom-right":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.width=l<k.itemMinWidth?k.itemMinWidth:l>m("right")?m("right"):l,u.isGroup===!0){const n=u.width-2*y,a=u.height-2*y-(u.groupTit?p:0);u.groupData.forEach(s=>{s.width=n*s.groupW,s.x=n*s.groupX,s.height=a*s.groupH,s.y=a*s.groupY})}break}let c=C(g.value.filter(n=>n.drag!==!0).filter(n=>n.x<u.x&&n.x+n.width>u.x||n.x===u.x||n.x>u.x&&n.x<u.x+u.width).filter(n=>n.y<u.y&&n.y+n.height>u.y||n.y===u.y||n.y>u.y&&n.y<u.y+u.height));if(c.length>0){c.sort((n,a)=>{const s=n.y,h=a.y;return s-h});for(let n=0;n<c.length;n++)c.filter(a=>a.id===c[n].id).forEach(a=>{a.y+=u.y+u.height-a.y,g.value.filter(h=>h.id===a.id)[0].y=a.y;const s=h=>{g.value.filter(f=>f.drag!==!0&&f.id!==h.id).filter(f=>f.x<h.x&&f.x+f.width>h.x||f.x===h.x||f.x>h.x&&f.x<h.x+h.width).filter(f=>f.y<h.y&&f.y+f.height>h.y||f.y===h.y||f.y>h.y&&f.y<h.y+h.height).forEach(f=>{f.y=h.y+h.height,s(f)})};s(a)})}v(!1)},gt=r=>{delete u.drag,ot="",u=null,window.removeEventListener("mousemove",pt),window.removeEventListener("mouseup",gt),v()},m=r=>{switch(r){case"top":return X+Y-_;case"left":return b+I-$;case"right":return(Z>0?Z:H)-b;case"bottom":return Q>0?Q-X:999999999}},v=(r=!0)=>{r===!0&&ft();const l=g.value.map(e=>e.y+e.height);l.length>0?K.value=Math.max(...l):K.value=0};t.watch(()=>k.ySpace,()=>{k.ySpace>=0&&ft()});const ft=()=>{const r=C(g.value).sort((l,e)=>{const i=l.y,o=e.y;return i-o});for(let l=0;l<r.length;l++){if(l===0&&r[l].y>0){const e=r[l].y;for(let i=l;i<r.length;i++)r[i].y-=e,g.value.filter(o=>o.id===r[i].id).y=r[i].y}if(l<r.length-1&&r[l+1].y>r[l].y+r[l].height){const e=C(r.slice(0,l+1));if(r[l+1].y>Math.max(...e.map(i=>i.y+i.height))){const i=r[l+1].y-Math.max(...e.map(o=>o.y+o.height));for(let o=l+1;o<r.length;o++)r[o].y-=i,g.value.filter(x=>x.id===r[o].id).y=r[o].y}}}for(let l=0;l<r.length-1;l++){let e=r.findIndex(i=>i.y===r[l].y+r[l].height);if(e!==-1)for(let i=e;i<r.length;i++)r[i].y+=k.ySpace,g.value.filter(o=>o.id===r[i].id).y=r[i].y}};t.onMounted(()=>{ut.observe(G.value)});const ut=new ResizeObserver(r=>{Ft(H===r[0].contentRect.width?null:r[0].contentRect.width,st===r[0].contentRect.height?null:r[0].contentRect.height)});let rt=!1;const Kt=(r=[],l=null)=>{g.value=C(r),g.value.filter(e=>e.isGroup===!0).forEach(e=>{if(e.isGroup===!0)if(e.groupData.length<2)q(e.id);else{const i=et(e.groupData,e);tt(i)}}),l!==null?t.nextTick(()=>{const i=G.value.getBoundingClientRect().width/l,o=getComputedStyle(G.value),x=parseInt(o.getPropertyValue("--com-item-border-width").trim()),d=parseInt(o.getPropertyValue("--group-tit-height").trim());g.value.forEach(M=>{if(M.width*=i,M.height*=i,M.x*=i,M.y*=i,M.isGroup===!0){const y=M.width-2*x,p=M.height-2*x-(M.groupTit?d:0);M.groupData.forEach(c=>{c.width=y*c.groupW,c.x=y*c.groupX,c.height=p*c.groupH,c.y=p*c.groupY})}}),v()}):v(),rt=!0,setTimeout(()=>{rt=!1},500)},yt=(r,l,e)=>{const i=l.map(d=>d.y),o=Math.max(...i),x=l.filter(d=>d.y+d.height>o);x.sort((d,M)=>{const y=d.x,p=M.x;return y-p});for(let d=0;d<x.length;d++){if(d===0&&x[d].x>=r.width){r.y=o,r.x=0;break}if(x.length>1&&d!==x.length-1&&x[d].x+x[d].width+r.width<=x[d+1].x){r.y=o,r.x=x[d].x+x[d].width;break}if(d===x.length-1&&x[d].x+x[d].width+r.width<=e){r.y=o,r.x=x[d].x+x[d].width;break}}if(r.y==null){r.x=0;const d=l.map(M=>M.y+M.height);r.y=Math.max(...d)}},j=(r,l=null,e=!1)=>{const i=C(r),o=g.value.filter(x=>x.id===l);if(i.id||(i.id=new Date().getTime()+""),l&&o.length!==1){try{}catch{}return}if(e!==!0)if(delete i.x,delete i.y,l){const x=getComputedStyle(G.value),d=parseInt(x.getPropertyValue("--com-item-border-width").trim());yt(i,o[0].groupData,o[0].width-2*d)}else g.value.length===0?(i.x=0,i.y=0):yt(i,g.value,H);if(l){o[0].groupData.push(i);const x=et(o[0].groupData,o[0]);tt(x)}else g.value.push(i);v()},A=(r,l=null)=>{let e=-1;const i=g.value.filter(o=>o.id===l);if(l?i.length===1&&(e=i[0].groupData.findIndex(o=>o.id===r)):e=g.value.findIndex(o=>o.id===r),e!==-1){if(l)if(i[0].groupData.splice(e,1),i[0].groupData.length===1)q(l);else{const o=et(i[0].groupData,i[0]);tt(o)}else g.value.splice(e,1);v()}else try{}catch{}},tt=r=>{if(r.id){const l=C(r);let e=-1;const i=g.value.filter(o=>o.id===l.inGroupId);if(l.inGroupId?i.length===1&&(e=i[0].groupData.findIndex(o=>o.id===l.id)):e=g.value.findIndex(o=>o.id===l.id),e!==-1)l.inGroupId?i[0].groupData[e]=l:g.value[e]=l,v();else try{}catch{}}else try{}catch{}},Ft=(r,l)=>{if(r!==null){const e=H?r/H:1;H=r;const i=getComputedStyle(G.value),o=parseInt(i.getPropertyValue("--com-item-border-width").trim()),x=parseInt(i.getPropertyValue("--group-tit-height").trim());rt||(g.value.forEach(d=>{if(d.width*=e,d.height*=e,d.x*=e,d.y*=e,d.isGroup===!0){const M=d.width-2*o,y=d.height-2*o-(d.groupTit?x:0);d.groupData.forEach(p=>{p.width=M*p.groupW,p.x=M*p.groupX,p.height=y*p.groupH,p.y=y*p.groupY})}}),v())}l!==null&&(st=l)},xt=r=>{r.showPop||(g.value.forEach(l=>{delete l.showPop,l.groupData&&l.groupData.forEach(e=>{delete e.showPop})}),r.showPop=!0,window.addEventListener("click",F))},F=()=>{g.value.forEach(r=>{delete r.showPop,r.groupData&&r.groupData.forEach(l=>{delete l.showPop})}),window.removeEventListener("click",F)},N=t.ref(!1),wt=r=>{const l=g.value.findIndex(e=>e.id===r);if(l!==-1)g.value[l].checked=!0,g.value[l].disabled=!0,N.value=!0,R("showGroup",N.value);else try{}catch{}},kt=()=>{N.value=!1,g.value.forEach(r=>{delete r.checked,delete r.disabled,r.groupData&&r.groupData.forEach(l=>{delete l.checked,delete l.disabled})}),R("showGroup",N.value)},qt=r=>{r.checked=!r.checked,R("updateChecked",g.value.filter(l=>l.checked).length)},et=(r,l)=>{const e=C(r),i=C(l);e.sort((c,n)=>{const a=c.x,s=n.x;return a-s});for(let c=0;c<e.length-1;c++){if(c===0&&e[c].x>0){const n=e[c].x;for(let a=c;a<e.length;a++)e[a].x-=n}if(e[c+1].x>e[c].x+e[c].width){const n=C(e.slice(0,c+1));if(e[c+1].x>Math.max(...n.map(a=>a.x+a.width))){const a=e[c+1].x-Math.max(...n.map(s=>s.x+s.width));for(let s=c+1;s<e.length;s++)e[s].x-=a}}}e.sort((c,n)=>{const a=c.y,s=n.y;return a-s});for(let c=0;c<e.length-1;c++){if(c===0&&e[c].y>0){const n=e[c].y;for(let a=c;a<e.length;a++)e[a].y-=n}if(e[c+1].y>e[c].y+e[c].height){const n=C(e.slice(0,c+1));if(e[c+1].y>Math.max(...n.map(a=>a.y+a.height))){const a=e[c+1].y-Math.max(...n.map(s=>s.y+s.height));for(let s=c+1;s<e.length;s++)e[s].y-=a}}}const o=e.map(c=>c.x+c.width),x=Math.max(...o),d=e.map(c=>c.y+c.height),M=Math.max(...d);e.forEach(c=>{c.inGroupId||(c.inGroupId=i.id),c.groupW=c.width/x,c.groupH=c.height/M,c.groupX=c.x/x,c.groupY=c.y/M,c.isObstacle=c.x+c.width===x&&c.y===0});const y=getComputedStyle(G.value),p=parseInt(y.getPropertyValue("--com-item-border-width").trim());return i.width=x+2*p,i.height=M+2*p,i.groupData=[...e],i},Ut=()=>{t.nextTick(()=>{const r=getComputedStyle(G.value),l=parseInt(r.getPropertyValue("--com-item-border-width").trim()),e=parseInt(r.getPropertyValue("--group-tit-height").trim());g.value.filter(i=>i.isGroup===!0).forEach(i=>{const o=i.width-2*l,x=i.height-2*l-(i.groupTit?e:0);i.groupData.forEach(d=>{d.width=o*d.groupW,d.x=o*d.groupX,d.height=x*d.groupH,d.y=x*d.groupY})})})},Jt=()=>{const r=g.value.filter(l=>l.checked);if(r.length>1){const l={id:new Date().getTime()+"G",isGroup:!0,groupTit:""},e=et(r,l);e.groupData.forEach(i=>{A(i.id)}),j(e),v()}kt()},Mt=(r,l)=>{const e=g.value.filter(i=>i.id===l)[0];if(e){const i=e.groupData.filter(o=>o.id===r)[0];if(i)e.groupData.length===2?q(l):(delete i.inGroupId,delete i.groupW,delete i.groupH,delete i.groupX,delete i.groupY,delete i.isObstacle,A(i.id,e.id),j(i),v());else try{}catch{}}else try{}catch{}},q=r=>{const l=g.value.filter(e=>e.id===r)[0];if(l)A(l.id),l.groupData.forEach(e=>{delete e.inGroupId,delete e.groupW,delete e.groupH,delete l.groupX,delete l.groupY,delete l.isObstacle,e.x+=l.x,e.y+=l.y,j(e,null,!0)}),v();else try{}catch{}},Qt=(r="",l)=>{const e=g.value.filter(i=>i.id===l)[0];if(e){if(!e.groupTit||!r){const o=getComputedStyle(G.value),x=parseInt(o.getPropertyValue("--group-tit-height").trim());e.groupTit&&!r&&(e.height-=x),!e.groupTit&&r&&(e.height+=x)}e.groupTit=r;const i=o=>{g.value.filter(d=>d.id!==o.id).filter(d=>d.x<o.x&&d.x+d.width>o.x||d.x===o.x||d.x>o.x&&d.x<o.x+o.width).filter(d=>d.y<o.y&&d.y+d.height>o.y||d.y===o.y||d.y>o.y&&d.y<o.y+o.height).forEach(d=>{d.y=o.y+o.height,i(d)})};i(e),v()}else try{}catch{}},Zt=()=>{const r=C(g.value);return r.forEach(l=>{delete l.showPop,l.groupData&&l.groupData.forEach(e=>{delete e.showPop})}),{data:r,width:H}};return t.onBeforeUnmount(()=>{ut.unobserve(G.value),window.removeEventListener("click",F)}),P({init:Kt,addItem:j,deleteItem:A,updateItem:tt,openGroup:wt,closeGroup:kt,changeGroupBorder:Ut,addGroup:Jt,removeGroupItem:Mt,removeGroup:q,changeGroupTit:Qt,getData:Zt}),(r,l)=>(t.openBlock(),t.createElementBlock("div",{class:"vue-drag-component-plus",ref_key:"pageRef",ref:G},[t.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:_t},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(g),(e,i)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item",E.seeModel||t.unref(N)||e.static===!0||e.dragable===!1?"":"can-drag",e.move?"is-move":"",e.drag?"is-drag":"",e.showPop?"on-top":"",E.seeModel?"no-hover":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:i,onMousedown:t.withModifiers(o=>E.seeModel||t.unref(N)||e.static===!0||e.dragable===!1?null:At(o,i),["prevent"])},[t.createElementVNode("div",mt,[e.isGroup?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[e.groupTit?(t.openBlock(),t.createElementBlock("div",{key:0,class:"group-item-tit",title:e.groupTit},t.toDisplayString(e.groupTit),9,Bt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:t.normalizeClass(["group-item-content",e.groupTit?"":"full"])},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.groupData,(o,x)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item-box-child",o.isObstacle?"else":""]),style:t.normalizeStyle({width:o.width+"px",height:o.height+"px",top:o.y+"px",left:o.x+"px"}),key:x},[t.createElementVNode("div",Dt,[t.renderSlot(r.$slots,"item",{data:o},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(o.width*100)/100)+","+t.toDisplayString(Math.round(o.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(o.x*100)/100)+","+t.toDisplayString(Math.round(o.y*100)/100),1)])]),!E.seeModel&&!t.unref(N)&&t.unref(B)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box",style:t.normalizeStyle({display:o.showPop?"flex":"none"}),onMousedown:t.withModifiers(d=>null,["prevent","stop"])},[t.createVNode(L,{iconObj:E.settingIcon,onClick:t.withModifiers(d=>xt(o),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),o.showPop?(t.openBlock(),t.createElementBlock("div",{key:1,class:"setting-box-pop",onMousedown:t.withModifiers(d=>null,["prevent","stop"])},[t.renderSlot(r.$slots,"setPopNormal",{data:C(o)},()=>[t.createElementVNode("div",{class:"setting-box-pop-item",onClick:d=>Mt(o.id,o.inGroupId)},"移出组合",8,Ct),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:d=>A(o.id,o.inGroupId)},"删除",8,Ot)])],32)):t.createCommentVNode("",!0)],6))),128))],2)],64)):(t.openBlock(),t.createElementBlock("div",Vt,[t.renderSlot(r.$slots,"item",{data:e},()=>[t.createElementVNode("p",null,t.toDisplayString(Math.round(e.width*100)/100)+","+t.toDisplayString(Math.round(e.height*100)/100),1),t.createElementVNode("p",null,t.toDisplayString(Math.round(e.x*100)/100)+","+t.toDisplayString(Math.round(e.y*100)/100),1)])])),!e.isGroup&&e.notGroup!==!0&&t.unref(N)?(t.openBlock(),t.createElementBlock("div",{key:2,class:t.normalizeClass(["group-checkbox",e.checked?"is-checked":"",e.disabled?"disabled":""]),onClick:o=>e.disabled?null:qt(e)},null,10,St)):t.createCommentVNode("",!0),!E.seeModel&&!t.unref(N)&&t.unref(B)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:3,class:"setting-box",style:t.normalizeStyle({display:e.showPop?"flex":"none"}),onMousedown:t.withModifiers(o=>null,["prevent","stop"])},[t.createVNode(L,{iconObj:E.settingIcon,onClick:t.withModifiers(o=>xt(e),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),e.showPop?(t.openBlock(),t.createElementBlock("div",{key:4,class:t.normalizeClass(["setting-box-pop",e.isGroup===!0?"special":""]),onMousedown:t.withModifiers(o=>null,["prevent","stop"])},[e.isGroup===!0?t.renderSlot(r.$slots,"setPopSpecial",{key:0,data:C(e)},()=>[E.hideTit?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:o=>R("showTitPop",e.groupTit,e.id)}," 设置组合标题",8,vt)),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:o=>q(e.id)},"解除组合",8,Gt)]):t.renderSlot(r.$slots,"setPopNormal",{key:1,data:C(e)},()=>[e.notGroup!==!0?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:o=>wt(e.id)},"组合",8,Nt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:o=>A(e.id)},"删除",8,zt)])],34)):t.createCommentVNode("",!0)]),!E.seeModel&&!t.unref(N)&&!e.move&&e.static!==!0&&e.resizable!==!1?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.unref(z).indexOf("topLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:0,class:"resize-line top-left",onMousedown:t.withModifiers(o=>T(o,e,"top-left"),["prevent","stop"])},null,40,Pt)):t.createCommentVNode("",!0),t.unref(z).indexOf("top")!==-1?(t.openBlock(),t.createElementBlock("div",{key:1,class:"resize-line top",onMousedown:t.withModifiers(o=>T(o,e,"top"),["prevent","stop"])},null,40,Ht)):t.createCommentVNode("",!0),t.unref(z).indexOf("topRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:2,class:"resize-line top-right",onMousedown:t.withModifiers(o=>T(o,e,"top-right"),["prevent","stop"])},null,40,Wt)):t.createCommentVNode("",!0),t.unref(z).indexOf("left")!==-1?(t.openBlock(),t.createElementBlock("div",{key:3,class:"resize-line left",onMousedown:t.withModifiers(o=>T(o,e,"left"),["prevent","stop"])},null,40,Tt)):t.createCommentVNode("",!0),t.unref(z).indexOf("right")!==-1?(t.openBlock(),t.createElementBlock("div",{key:4,class:"resize-line right",onMousedown:t.withModifiers(o=>T(o,e,"right"),["prevent","stop"])},null,40,It)):t.createCommentVNode("",!0),t.unref(z).indexOf("bottomLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:5,class:"resize-line bottom-left",onMousedown:t.withModifiers(o=>T(o,e,"bottom-left"),["prevent","stop"])},null,40,Yt)):t.createCommentVNode("",!0),t.unref(z).indexOf("bottom")!==-1?(t.openBlock(),t.createElementBlock("div",{key:6,class:"resize-line bottom",onMousedown:t.withModifiers(o=>T(o,e,"bottom"),["prevent","stop"])},null,40,Xt)):t.createCommentVNode("",!0),t.unref(z).indexOf("bottomRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:7,class:"resize-line bottom-right",onMousedown:t.withModifiers(o=>T(o,e,"bottom-right"),["prevent","stop"])},null,40,bt)):t.createCommentVNode("",!0)],64)):t.createCommentVNode("",!0)],46,Et))),128)),t.unref(B)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"drag-bg",style:t.normalizeStyle({width:t.unref(O).width+"px",height:t.unref(O).height+"px",top:t.unref(O).y+"px",left:t.unref(O).x+"px"})},null,4)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"height-bg",style:t.normalizeStyle({height:(t.unref(K)>0?+(t.unref(K)+(E.seeModel?E.seeModelMinBg:220)):t.unref(K))+"px"})},null,4),t.unref(g).length===0?(t.openBlock(),t.createElementBlock("div",Lt,[t.renderSlot(r.$slots,"empty",{},()=>[t.createTextVNode(" 暂无数据 ")])])):t.createCommentVNode("",!0)],512)],512))}}],lt={install(E){Rt.forEach(P=>{E.component("vueDragComponentPlus",P)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(lt),lt});
