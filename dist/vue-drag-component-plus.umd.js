(function(t,b){typeof exports=="object"&&typeof module<"u"?module.exports=b(require("vue")):typeof define=="function"&&define.amd?define(["vue"],b):(t=typeof globalThis<"u"?globalThis:t||self,t.vueDragComponentPlus=b(t.Vue))})(this,function(t){"use strict";const b={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(B){return(R,st)=>{const _=t.resolveComponent("el-icon");return B.iconObj.type==="custom"?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(B.iconObj.icon),t.normalizeProps(t.mergeProps({key:0},B.iconObj.attrs)),null,16)):B.iconObj.type==="el"?(t.openBlock(),t.createBlock(_,t.normalizeProps(t.mergeProps({key:1},B.iconObj.attrs)),{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(B.iconObj.icon)))]),_:1},16)):B.iconObj.type==="iconfont"?(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:2,class:["icon iconfont","icon-"+B.iconObj.icon]},B.iconObj.attrs),null,16)):(t.openBlock(),t.createElementBlock("i",t.mergeProps({key:3,class:B.iconObj.type},B.iconObj.attrs),t.toDisplayString(B.iconObj.icon),17))}}},Ut="",Et=["onMousedown"],mt={class:"com-item-content"},Bt=["title"],Ct=["onClick"],Dt=["onClick"],Ot=["onClick"],vt=["onClick"],Vt=["onClick"],zt=["onClick"],St=["onClick"],Nt=["onMousedown"],Gt=["onMousedown"],Ht=["onMousedown"],Tt=["onMousedown"],Wt=["onMousedown"],Pt=["onMousedown"],It=["onMousedown"],Yt=["onMousedown"],Xt={key:1,class:"com-empty"},bt=[{__name:"index",props:{insertResizeKeys:{type:Array,default:()=>["topLeft","top","topRight","left","right","bottomLeft","bottom","bottomRight"]},excludeResizeKeys:{type:Array,default:()=>[]},seeModel:{type:Boolean,default:!1},itemMinWidth:{type:Number,default:15,validator(B,R){return B>=15}},itemMinHeight:{type:Number,default:15,validator(B,R){return B>=15}},settingIcon:{type:Object,default:()=>({icon:"设置"})},hideTit:{type:Boolean,default:!1}},emits:["showGroup","updateChecked","showTitPop"],setup(B,{expose:R,emit:st}){const _=st,k=B,v=r=>{let i=r instanceof Array?[]:{};for(let e in r)i[e]=typeof r[e]=="object"?v(r[e]):r[e];return i},at=()=>{k.insertResizeKeys.forEach(r=>{k.excludeResizeKeys.indexOf(r)===-1&&G.value.push(r)})};t.watch(()=>[k.insertResizeKeys,k.excludeResizeKeys],()=>{at()});const G=t.ref([]);at();const S=t.ref(null);let H=null,q=null;const K=t.ref(null),U=t.ref(0),g=t.ref([]),Rt=(r,i)=>{let e=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;for(;r&&!e.call(r,i);)r=r.parentElement;return r};let E=null,ct=null,ht=null;const D=t.ref({}),_t=(r,i)=>{F(),E=i,D.value=v(g.value[E]),g.value[E].move=!0;const e=Rt(r.target,".com-item");ct=r.clientX-e.offsetLeft,ht=r.clientY-e.offsetTop,window.addEventListener("mousemove",dt),window.addEventListener("mouseup",pt)},dt=r=>{const i=r.clientX-ct,e=r.clientY-ht,n=i<=T("left")?T("left"):i>=T("right")?T("right"):i,o=e<=T("top")?T("top"):e>=T("bottom")?T("bottom"):e,x=n-g.value[E].x,f=o-g.value[E].y,M=`${x>0?"right":x<0?"left":""}_${f>0?"bottom":f<0?"top":""}`;o>g.value[E].y&&o>q-g.value[E].height-30&&K.value.scrollBy(0,20),o<g.value[E].y&&o-K.value.scrollTop<30&&K.value.scrollBy(0,-20),g.value[E].x=n,g.value[E].y=o;let y=v(g.value.filter(d=>d.move!==!0).filter(d=>d.x<n&&d.x+d.width>n||d.x===n||d.x>n&&d.x<n+g.value[E].width).filter(d=>d.y<o&&d.y+d.height>o||d.y===o||d.y>o&&d.y<o+g.value[E].height));if(y.length===0)D.value.x=n,D.value.y=o;else{if(M.indexOf("top")!==-1){y=y.filter(c=>c.y<D.value.y);const d=Math.min(...y.map(c=>c.y+c.height));y.forEach(c=>{Math.abs(c.y+c.height-d)<5&&(c.y=d-c.height)});let a=D.value.y-o,l=!0,s=[...y];const h=c=>{v(g.value.filter(p=>p.move!==!0&&p.y+p.height-c.y<=a+3&&p.y+p.height-c.y>=0).filter(p=>p.x<c.x&&p.x+p.width>c.x||p.x>=c.x&&p.x<c.x+c.width)).forEach(p=>{p.y+p.height!==c.y&&(p.y=c.y-p.height),s.findIndex(C=>C.id===p.id)===-1&&(s.push(p),h(p))})};if(y.forEach(c=>{h(c)}),s.sort((c,w)=>{const p=c.y,C=w.y;return p-C}),(s.length===0||s.filter(c=>c.y===0).length>0)&&(l=!1),l){let c=0;s.filter(p=>p.y===s[0].y).forEach(p=>{v(g.value.filter(V=>V.move!==!0&&V.y+V.height<p.y).filter(V=>V.x<p.x&&V.x+V.width>p.x||V.x>=p.x&&V.x<p.x+p.width)).forEach(V=>{V.y+V.height>c&&(c=V.y+V.height)})}),c=s[0].y-c,c<a&&(a=c),s.forEach(p=>{p.y-=a,g.value.filter(C=>C.id===p.id)[0].y=p.y}),D.value.x=n,D.value.y=g.value.filter(p=>p.id===s[s.length-1].id)[0].y+g.value.filter(p=>p.id===s[s.length-1].id)[0].height}else{const c=Math.min(...y.map(w=>w.y));c-o>=-7&&c-o<7&&(y.filter(w=>w.y<D.value.y).forEach(w=>{w.y+=g.value[E].height,g.value.filter(C=>C.id===w.id)[0].y=w.y;const p=C=>{g.value.filter(O=>O.move!==!0&&O.id!==C.id).filter(O=>O.x<C.x&&O.x+O.width>C.x||O.x===C.x||O.x>C.x&&O.x<C.x+C.width).filter(O=>O.y<C.y&&O.y+O.height>C.y||O.y===C.y||O.y>C.y&&O.y<C.y+C.height).forEach(O=>{O.y=C.y+C.height,p(O)})};p(w)}),D.value.x=n,D.value.y=c)}y=v(g.value.filter(c=>c.move!==!0).filter(c=>c.x<n&&c.x+c.width>n||c.x===n||c.x>n&&c.x<n+g.value[E].width).filter(c=>c.y<o&&c.y+c.height>o||c.y===o||c.y>o&&c.y<o+g.value[E].height))}if(M.indexOf("bottom")!==-1){const d=Math.max(...y.map(a=>a.y+a.height));if(d-(o+g.value[E].height)>=-7&&d-(o+g.value[E].height)<7){let a=!0;y.filter(l=>l.y>D.value.y).forEach(l=>{l.y-=g.value[E].height,g.value.filter(h=>h.id===l.id)[0].y=l.y;const s=g.value.filter(h=>h.move!==!0&&h.id!==l.id).filter(h=>h.x<l.x&&h.x+h.width>l.x||h.x===l.x||h.x>l.x&&h.x<l.x+l.width).filter(h=>h.y<l.y&&h.y+h.height>l.y||h.y===l.y||h.y>l.y&&h.y<l.y+l.height);if(s.length>0){l.y=Math.max(...s.map(c=>c.y+c.height)),g.value.filter(c=>c.id===l.id)[0].y=l.y;const h=c=>{g.value.filter(p=>p.id!==c.id).filter(p=>p.x<c.x&&p.x+p.width>c.x||p.x===c.x||p.x>c.x&&p.x<c.x+c.width).filter(p=>p.y<c.y&&p.y+p.height>c.y||p.y===c.y||p.y>c.y&&p.y<c.y+c.height).forEach(p=>{p.y=c.y+c.height,p.move===!0&&(D.value.y=p.y,a=!1),h(p)})};h(l)}}),D.value.x=n,a&&(D.value.y=d-g.value[E].height),y=v(g.value.filter(l=>l.move!==!0).filter(l=>l.x<n&&l.x+l.width>n||l.x===n||l.x>n&&l.x<n+g.value[E].width).filter(l=>l.y<o&&l.y+l.height>o||l.y===o||l.y>o&&l.y<o+g.value[E].height))}}if(((M.indexOf("top")!==-1||M.indexOf("bottom")!==-1)&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1)&&Math.abs(x)>8||M.indexOf("top")===-1&&M.indexOf("bottom")===-1&&(M.indexOf("right")!==-1||M.indexOf("left")!==-1))&&y.length>0){y.sort((a,l)=>{const s=a.y,h=l.y;return s-h});let d=!0;for(let a=0;a<y.length;a++){if(d){const l=v(g.value);for(let s=0;s<=a;s++){let h=null;const c=l.filter(w=>w.move!==!0&&w.y<y[s].y).filter(w=>w.x<y[s].x&&w.x+w.width>y[s].x||w.x===y[s].x||w.x>y[s].x&&w.x<y[s].x+y[s].width);if(c.length===0?h=0:h=Math.max(...c.map(w=>w.y+w.height)),s===a){if(y[s].y-(y[s].y+y[s].height-o)<h){d=!1;break}}else if(y[s].y-y[a].height<h){d=!1;break}else l.filter(w=>w.id===y[s].id)[0].y-=y[a].height}}if(d){y[a].y-=y[a].y+y[a].height-o,g.value.filter(l=>l.id===y[a].id)[0].y=y[a].y;for(let l=a;l>0;l--)y[a-1].y-=y[a].height,g.value.filter(s=>s.id===y[a-1].id)[0].y=y[a-1].y}else y.filter(l=>l.id===y[a].id).forEach(l=>{l.y+=g.value[E].y+g.value[E].height-l.y,g.value.filter(h=>h.id===l.id)[0].y=l.y;const s=h=>{g.value.filter(w=>w.move!==!0&&w.id!==h.id).filter(w=>w.x<h.x&&w.x+w.width>h.x||w.x===h.x||w.x>h.x&&w.x<h.x+h.width).filter(w=>w.y<h.y&&w.y+w.height>h.y||w.y===h.y||w.y>h.y&&w.y<h.y+h.height).forEach(w=>{w.y=h.y+h.height,s(w)})};s(l)})}D.value.x=n}}z()},pt=()=>{window.removeEventListener("mousemove",dt),window.removeEventListener("mouseup",pt),setTimeout(()=>{delete g.value[E].move,g.value[E].x=D.value.x,g.value[E].y=D.value.y,E=null},30)},T=r=>{switch(r){case"top":return 0;case"right":return H-g.value[E].width;case"bottom":return 999999999;case"left":return 0}};let u=null,ot="",J=0,Q=0,P=0,I=0,Y=0,X=0,$=0,Z=0,L=0,j=0;const W=(r,i,e)=>{F(),u=i,ot=e,J=r.clientX,Q=r.clientY,P=i.width,I=i.height,Y=i.y,X=i.x,u.drag=!0;const n=g.value.filter(d=>d.static===!0&&(d.x<i.x?d.x+d.width>=i.x:d.x<=i.x+i.width)),o=g.value.filter(d=>d.static===!0&&(d.y<i.y?d.y+d.height>=i.y:d.y<=i.y+i.height)),x=n.filter(d=>d.y+d.height<=i.y).map(d=>d.y+d.height);x.length>0?$=Math.max(...x):$=0;const f=n.filter(d=>d.y>=i.y+i.height).map(d=>d.y);f.length>0?Z=Math.min(...f):Z=0;const M=o.filter(d=>d.x+d.width<=i.x).map(d=>d.x+d.width);M.length>0?L=Math.max(...M):L=0;const y=o.filter(d=>d.x>=i.x+i.width).map(d=>d.x);y.length>0?j=Math.min(...y):j=0,window.addEventListener("mousemove",gt),window.addEventListener("mouseup",ft)},gt=r=>{const i=P+(r.clientX-J),e=I+(r.clientY-Q),n=P-(r.clientX-J),o=I-(r.clientY-Q),x=Y+(r.clientY-Q),f=X+(r.clientX-J),M=getComputedStyle(S.value),y=parseInt(M.getPropertyValue("--com-item-border-width").trim()),d=parseInt(M.getPropertyValue("--group-tit-height").trim());switch(ot){case"top-left":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?Y+I-k.itemMinHeight:o>m("top")?$:x,u.width=n<k.itemMinWidth?k.itemMinWidth:n>m("left")?m("left"):n,u.x=n<k.itemMinWidth?X+P-k.itemMinWidth:n>m("left")?L:f,u.isGroup===!0){const l=u.width-2*y,s=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(h=>{h.width=l*h.groupW,h.x=l*h.groupX,h.height=s*h.groupH,h.y=s*h.groupY})}break;case"top":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?Y+I-k.itemMinHeight:o>m("top")?$:x,u.isGroup===!0){const l=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(s=>{s.height=l*s.groupH,s.y=l*s.groupY})}break;case"top-right":if(u.height=o<k.itemMinHeight?k.itemMinHeight:o>m("top")?m("top"):o,u.y=o<k.itemMinHeight?Y+I-k.itemMinHeight:o>m("top")?$:x,u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("right")?m("right"):i,u.isGroup===!0){const l=u.width-2*y,s=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(h=>{h.width=l*h.groupW,h.x=l*h.groupX,h.height=s*h.groupH,h.y=s*h.groupY})}break;case"left":if(u.width=n<k.itemMinWidth?k.itemMinWidth:n>m("left")?m("left"):n,u.x=n<k.itemMinWidth?X+P-k.itemMinWidth:n>m("left")?L:f,u.isGroup===!0){const l=u.width-2*y;u.groupData.forEach(s=>{s.width=l*s.groupW,s.x=l*s.groupX})}break;case"right":if(u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("right")?m("right"):i,u.isGroup===!0){const l=u.width-2*y;u.groupData.forEach(s=>{s.width=l*s.groupW,s.x=l*s.groupX})}break;case"bottom-left":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.width=n<k.itemMinWidth?k.itemMinWidth:n>m("left")?m("left"):n,u.x=n<k.itemMinWidth?X+P-k.itemMinWidth:n>m("left")?L:f,u.isGroup===!0){const l=u.width-2*y,s=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(h=>{h.width=l*h.groupW,h.x=l*h.groupX,h.height=s*h.groupH,h.y=s*h.groupY})}break;case"bottom":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.isGroup===!0){const l=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(s=>{s.height=l*s.groupH,s.y=l*s.groupY})}break;case"bottom-right":if(u.height=e<k.itemMinHeight?k.itemMinHeight:e>m("bottom")?m("bottom"):e,u.width=i<k.itemMinWidth?k.itemMinWidth:i>m("right")?m("right"):i,u.isGroup===!0){const l=u.width-2*y,s=u.height-2*y-(u.groupTit?d:0);u.groupData.forEach(h=>{h.width=l*h.groupW,h.x=l*h.groupX,h.height=s*h.groupH,h.y=s*h.groupY})}break}let a=v(g.value.filter(l=>l.drag!==!0).filter(l=>l.x<u.x&&l.x+l.width>u.x||l.x===u.x||l.x>u.x&&l.x<u.x+u.width).filter(l=>l.y<u.y&&l.y+l.height>u.y||l.y===u.y||l.y>u.y&&l.y<u.y+u.height));if(a.length>0){a.sort((l,s)=>{const h=l.y,c=s.y;return h-c});for(let l=0;l<a.length;l++)a.filter(s=>s.id===a[l].id).forEach(s=>{s.y+=u.y+u.height-s.y,g.value.filter(c=>c.id===s.id)[0].y=s.y;const h=c=>{g.value.filter(p=>p.drag!==!0&&p.id!==c.id).filter(p=>p.x<c.x&&p.x+p.width>c.x||p.x===c.x||p.x>c.x&&p.x<c.x+c.width).filter(p=>p.y<c.y&&p.y+p.height>c.y||p.y===c.y||p.y>c.y&&p.y<c.y+c.height).forEach(p=>{p.y=c.y+c.height,h(p)})};h(s)})}z(),K.value.scrollTo(0,U.value-q)},ft=r=>{delete u.drag,ot="",u=null,window.removeEventListener("mousemove",gt),window.removeEventListener("mouseup",ft)},m=r=>{switch(r){case"top":return Y+I-$;case"left":return X+P-L;case"right":return(j>0?j:H)-X;case"bottom":return Z>0?Z-Y:999999999}},z=()=>{const r=g.value.map(i=>i.y+i.height);r.length>0?U.value=Math.max(...r)+50:U.value=0};t.onMounted(()=>{ut.observe(S.value)});const ut=new ResizeObserver(r=>{Lt(H===r[0].contentRect.width?null:r[0].contentRect.width,q===r[0].contentRect.height?null:r[0].contentRect.height)});let lt=!1;const $t=(r=[],i=null)=>{g.value=v(r),i!==null?t.nextTick(()=>{const n=S.value.getBoundingClientRect().width/i,o=getComputedStyle(S.value),x=parseInt(o.getPropertyValue("--com-item-border-width").trim()),f=parseInt(o.getPropertyValue("--group-tit-height").trim());g.value.forEach(M=>{if(M.width*=n,M.height*=n,M.x*=n,M.y*=n,M.isGroup===!0){const y=M.width-2*x,d=M.height-2*x-(M.groupTit?f:0);M.groupData.forEach(a=>{a.width=y*a.groupW,a.x=y*a.groupX,a.height=d*a.groupH,a.y=d*a.groupY})}}),z()}):z(),lt=!0,setTimeout(()=>{lt=!1},500)},yt=(r,i,e)=>{const n=i.map(f=>f.y),o=Math.max(...n),x=i.filter(f=>f.y+f.height>o);x.sort((f,M)=>{const y=f.x,d=M.x;return y-d});for(let f=0;f<x.length;f++){if(f===0&&x[f].x>=r.width){r.y=o,r.x=0;break}if(x.length>1&&f!==x.length-1&&x[f].x+x[f].width+r.width<=x[f+1].x){r.y=o,r.x=x[f].x+x[f].width;break}if(f===x.length-1&&x[f].x+x[f].width+r.width<=e){r.y=o,r.x=x[f].x+x[f].width;break}}if(r.y==null){r.x=0;const f=i.map(M=>M.y+M.height);r.y=Math.max(...f)}},tt=(r,i=null,e=!1)=>{const n=v(r),o=g.value.filter(x=>x.id===i);if(n.id||(n.id=new Date().getTime()+""),i&&o.length!==1){try{}catch{}return}if(e!==!0)if(delete n.x,delete n.y,i){const x=getComputedStyle(S.value),f=parseInt(x.getPropertyValue("--com-item-border-width").trim());yt(n,o[0].groupData,o[0].width-2*f)}else g.value.length===0?(n.x=0,n.y=0):yt(n,g.value,H);if(i){o[0].groupData.push(n);const x=it(o[0].groupData,o[0]);rt(x)}else g.value.push(n);z()},A=(r,i=null)=>{let e=-1;const n=g.value.filter(o=>o.id===i);if(i?n.length===1&&(e=n[0].groupData.findIndex(o=>o.id===r)):e=g.value.findIndex(o=>o.id===r),e!==-1){if(i)if(n[0].groupData.splice(e,1),n[0].groupData.length===1)et(i);else{const o=it(n[0].groupData,n[0]);rt(o)}else g.value.splice(e,1);z()}else try{}catch{}},rt=r=>{if(r.id){const i=v(r);let e=-1;const n=g.value.filter(o=>o.id===i.inGroupId);if(i.inGroupId?n.length===1&&(e=n[0].groupData.findIndex(o=>o.id===i.id)):e=g.value.findIndex(o=>o.id===i.id),e!==-1)i.inGroupId?n[0].groupData[e]=i:g.value[e]=i,z();else try{}catch{}}else try{}catch{}},Lt=(r,i)=>{if(r!==null){const e=H?r/H:1;H=r;const n=getComputedStyle(S.value),o=parseInt(n.getPropertyValue("--com-item-border-width").trim()),x=parseInt(n.getPropertyValue("--group-tit-height").trim());lt||(g.value.forEach(f=>{if(f.width*=e,f.height*=e,f.x*=e,f.y*=e,f.isGroup===!0){const M=f.width-2*o,y=f.height-2*o-(f.groupTit?x:0);f.groupData.forEach(d=>{d.width=M*d.groupW,d.x=M*d.groupX,d.height=y*d.groupH,d.y=y*d.groupY})}}),z())}i!==null&&(q=i)},xt=r=>{r.showPop||(g.value.forEach(i=>{delete i.showPop,i.groupData&&i.groupData.forEach(e=>{delete e.showPop})}),r.showPop=!0,window.addEventListener("click",F))},F=()=>{g.value.forEach(r=>{delete r.showPop,r.groupData&&r.groupData.forEach(i=>{delete i.showPop})}),window.removeEventListener("click",F)},N=t.ref(!1),wt=r=>{const i=g.value.findIndex(e=>e.id===r);if(i!==-1)g.value[i].checked=!0,g.value[i].disabled=!0,N.value=!0,_("showGroup",N.value);else try{}catch{}},kt=()=>{N.value=!1,g.value.forEach(r=>{delete r.checked,delete r.disabled,r.groupData&&r.groupData.forEach(i=>{delete i.checked,delete i.disabled})}),_("showGroup",N.value)},At=r=>{r.checked=!r.checked,_("updateChecked",g.value.filter(i=>i.checked).length)},it=(r,i)=>{const e=v(r),n=v(i);e.sort((a,l)=>{const s=a.x,h=l.x;return s-h});for(let a=0;a<e.length-1;a++){if(a===0&&e[a].x>0){const l=e[a].x;for(let s=a;s<e.length;s++)e[s].x-=l}if(e[a+1].x>e[a].x+e[a].width){const l=e[a+1].x-(e[a].x+e[a].width);for(let s=a+1;s<e.length;s++)e[s].x-=l}}e.sort((a,l)=>{const s=a.y,h=l.y;return s-h});for(let a=0;a<e.length-1;a++){if(a===0&&e[a].y>0){const l=e[a].y;for(let s=a;s<e.length;s++)e[s].y-=l}if(e[a+1].y>e[a].y+e[a].height){const l=e[a+1].y-(e[a].y+e[a].height);for(let s=a+1;s<e.length;s++)e[s].y-=l}}const o=e.map(a=>a.x+a.width),x=Math.max(...o),f=e.map(a=>a.y+a.height),M=Math.max(...f);e.forEach(a=>{a.inGroupId||(a.inGroupId=n.id),a.groupW=a.width/x,a.groupH=a.height/M,a.groupX=a.x/x,a.groupY=a.y/M,a.isObstacle=a.x+a.width===x&&a.y===0});const y=getComputedStyle(S.value),d=parseInt(y.getPropertyValue("--com-item-border-width").trim());return n.width=x+2*d,n.height=M+2*d,n.groupData=[...e],n},Kt=()=>{const r=g.value.filter(i=>i.checked);if(r.length>1){const i={id:new Date().getTime()+"G",isGroup:!0,groupTit:""},e=it(r,i);e.groupData.forEach(n=>{A(n.id)}),tt(e),z()}kt()},Mt=(r,i)=>{const e=g.value.filter(n=>n.id===i)[0];if(e){const n=e.groupData.filter(o=>o.id===r)[0];if(n)e.groupData.length===2?et(i):(delete n.inGroupId,delete n.groupW,delete n.groupH,delete n.groupX,delete n.groupY,delete n.isObstacle,A(n.id,e.id),tt(n),z());else try{}catch{}}else try{}catch{}},et=r=>{const i=g.value.filter(e=>e.id===r)[0];if(i)A(i.id),i.groupData.forEach(e=>{delete e.inGroupId,delete e.groupW,delete e.groupH,delete i.groupX,delete i.groupY,delete i.isObstacle,e.x+=i.x,e.y+=i.y,tt(e,null,!0)}),z();else try{}catch{}},Ft=(r="",i)=>{const e=g.value.filter(n=>n.id===i)[0];if(e){if(!e.groupTit||!r){const o=getComputedStyle(S.value),x=parseInt(o.getPropertyValue("--group-tit-height").trim());e.groupTit&&!r&&(e.height-=x),!e.groupTit&&r&&(e.height+=x)}e.groupTit=r;const n=o=>{g.value.filter(f=>f.id!==o.id).filter(f=>f.x<o.x&&f.x+f.width>o.x||f.x===o.x||f.x>o.x&&f.x<o.x+o.width).filter(f=>f.y<o.y&&f.y+f.height>o.y||f.y===o.y||f.y>o.y&&f.y<o.y+o.height).forEach(f=>{f.y=o.y+o.height,n(f)})};n(e),z()}else try{}catch{}},qt=()=>({data:v(g.value),width:H});return t.onBeforeUnmount(()=>{ut.unobserve(S.value),window.removeEventListener("click",F)}),R({init:$t,addItem:tt,deleteItem:A,updateItem:rt,openGroup:wt,closeGroup:kt,addGroup:Kt,removeGroupItem:Mt,removeGroup:et,changeGroupTit:Ft,getData:qt}),(r,i)=>(t.openBlock(),t.createElementBlock("div",{class:"vue-drag-component-plus",ref_key:"pageRef",ref:S},[t.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:K},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(g),(e,n)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item",B.seeModel||t.unref(N)||e.static===!0||e.dragable===!1?"":"can-drag",e.move?"is-move":"",e.drag?"is-drag":"",e.showPop?"on-top":"",B.seeModel?"no-hover":""]),style:t.normalizeStyle({width:e.width+"px",height:e.height+"px",top:e.y+"px",left:e.x+"px"}),key:n,onMousedown:t.withModifiers(o=>B.seeModel||t.unref(N)||e.static===!0||e.dragable===!1?null:_t(o,n),["prevent"])},[t.createElementVNode("div",mt,[e.isGroup?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[e.groupTit?(t.openBlock(),t.createElementBlock("div",{key:0,class:"group-item-tit",title:e.groupTit},t.toDisplayString(e.groupTit),9,Bt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:t.normalizeClass(["group-item-content",e.groupTit?"":"full"])},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.groupData,(o,x)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["com-item-content-child",o.isObstacle?"else":""]),style:t.normalizeStyle({width:o.width+"px",height:o.height+"px",top:o.y+"px",left:o.x+"px"}),key:x},[t.renderSlot(r.$slots,"item",{data:o},()=>[t.createElementVNode("p",null,t.toDisplayString(o.width)+","+t.toDisplayString(o.height),1),t.createElementVNode("p",null,t.toDisplayString(o.x)+","+t.toDisplayString(o.y),1)]),!B.seeModel&&!t.unref(N)&&t.unref(E)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box",style:t.normalizeStyle({display:o.showPop?"flex":"none"}),onMousedown:t.withModifiers(f=>null,["prevent","stop"])},[t.createVNode(b,{iconObj:B.settingIcon,onClick:t.withModifiers(f=>xt(o),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),o.showPop?(t.openBlock(),t.createElementBlock("div",{key:1,class:"setting-box-pop",onMousedown:t.withModifiers(f=>null,["prevent","stop"])},[t.renderSlot(r.$slots,"setPopNormal",{data:v(o)},()=>[t.createElementVNode("div",{class:"setting-box-pop-item",onClick:f=>Mt(o.id,o.inGroupId)},"移出组合",8,Ct),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:f=>A(o.id,o.inGroupId)},"删除",8,Dt)])],32)):t.createCommentVNode("",!0)],6))),128))],2)],64)):t.renderSlot(r.$slots,"item",{key:1,data:e},()=>[t.createElementVNode("p",null,t.toDisplayString(e.width)+","+t.toDisplayString(e.height),1),t.createElementVNode("p",null,t.toDisplayString(e.x)+","+t.toDisplayString(e.y),1)]),!e.isGroup&&e.notGroup!==!0&&t.unref(N)?(t.openBlock(),t.createElementBlock("div",{key:2,class:t.normalizeClass(["group-checkbox",e.checked?"is-checked":"",e.disabled?"disabled":""]),onClick:o=>e.disabled?null:At(e)},null,10,Ot)):t.createCommentVNode("",!0),!B.seeModel&&!t.unref(N)&&t.unref(E)===null&&t.unref(u)===null?(t.openBlock(),t.createElementBlock("div",{key:3,class:"setting-box",style:t.normalizeStyle({display:e.showPop?"flex":"none"}),onMousedown:t.withModifiers(o=>null,["prevent","stop"])},[t.createVNode(b,{iconObj:B.settingIcon,onClick:t.withModifiers(o=>xt(e),["prevent","stop"])},null,8,["iconObj","onClick"])],36)):t.createCommentVNode("",!0),e.showPop?(t.openBlock(),t.createElementBlock("div",{key:4,class:t.normalizeClass(["setting-box-pop",e.isGroup===!0?"special":""]),onMousedown:t.withModifiers(o=>null,["prevent","stop"])},[e.isGroup===!0?t.renderSlot(r.$slots,"setPopSpecial",{key:0,data:v(e)},()=>[B.hideTit?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:o=>_("showTitPop",e.groupTit,e.id)}," 设置组合标题",8,vt)),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:o=>et(e.id)},"解除组合",8,Vt)]):t.renderSlot(r.$slots,"setPopNormal",{key:1,data:v(e)},()=>[e.notGroup!==!0?(t.openBlock(),t.createElementBlock("div",{key:0,class:"setting-box-pop-item",onClick:o=>wt(e.id)},"组合",8,zt)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"setting-box-pop-item",onClick:o=>A(e.id)},"删除",8,St)])],34)):t.createCommentVNode("",!0)]),!B.seeModel&&!t.unref(N)&&!e.move&&e.static!==!0&&e.resizable!==!1?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.unref(G).indexOf("topLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:0,class:"resize-line top-left",onMousedown:t.withModifiers(o=>W(o,e,"top-left"),["prevent","stop"])},null,40,Nt)):t.createCommentVNode("",!0),t.unref(G).indexOf("top")!==-1?(t.openBlock(),t.createElementBlock("div",{key:1,class:"resize-line top",onMousedown:t.withModifiers(o=>W(o,e,"top"),["prevent","stop"])},null,40,Gt)):t.createCommentVNode("",!0),t.unref(G).indexOf("topRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:2,class:"resize-line top-right",onMousedown:t.withModifiers(o=>W(o,e,"top-right"),["prevent","stop"])},null,40,Ht)):t.createCommentVNode("",!0),t.unref(G).indexOf("left")!==-1?(t.openBlock(),t.createElementBlock("div",{key:3,class:"resize-line left",onMousedown:t.withModifiers(o=>W(o,e,"left"),["prevent","stop"])},null,40,Tt)):t.createCommentVNode("",!0),t.unref(G).indexOf("right")!==-1?(t.openBlock(),t.createElementBlock("div",{key:4,class:"resize-line right",onMousedown:t.withModifiers(o=>W(o,e,"right"),["prevent","stop"])},null,40,Wt)):t.createCommentVNode("",!0),t.unref(G).indexOf("bottomLeft")!==-1?(t.openBlock(),t.createElementBlock("div",{key:5,class:"resize-line bottom-left",onMousedown:t.withModifiers(o=>W(o,e,"bottom-left"),["prevent","stop"])},null,40,Pt)):t.createCommentVNode("",!0),t.unref(G).indexOf("bottom")!==-1?(t.openBlock(),t.createElementBlock("div",{key:6,class:"resize-line bottom",onMousedown:t.withModifiers(o=>W(o,e,"bottom"),["prevent","stop"])},null,40,It)):t.createCommentVNode("",!0),t.unref(G).indexOf("bottomRight")!==-1?(t.openBlock(),t.createElementBlock("div",{key:7,class:"resize-line bottom-right",onMousedown:t.withModifiers(o=>W(o,e,"bottom-right"),["prevent","stop"])},null,40,Yt)):t.createCommentVNode("",!0)],64)):t.createCommentVNode("",!0)],46,Et))),128)),t.unref(E)!==null?(t.openBlock(),t.createElementBlock("div",{key:0,class:"drag-bg",style:t.normalizeStyle({width:t.unref(D).width+"px",height:t.unref(D).height+"px",top:t.unref(D).y+"px",left:t.unref(D).x+"px"})},null,4)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:"height-bg",style:t.normalizeStyle({height:t.unref(U)+"px"})},null,4),t.unref(g).length===0?(t.openBlock(),t.createElementBlock("div",Xt,[t.renderSlot(r.$slots,"empty",{},()=>[t.createTextVNode(" 暂无数据 ")])])):t.createCommentVNode("",!0)],512)],512))}}],nt={install(B){bt.forEach(R=>{B.component("vueDragComponentPlus",R)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(nt),nt});
