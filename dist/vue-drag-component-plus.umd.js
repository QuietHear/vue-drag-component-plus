(function(e,B){typeof exports=="object"&&typeof module<"u"?module.exports=B(require("vue")):typeof define=="function"&&define.amd?define(["vue"],B):(e=typeof globalThis<"u"?globalThis:e||self,e.vueDragComponentPlus=B(e.Vue))})(this,function(e){"use strict";const B={__name:"icon",props:{iconObj:{type:Object,requured:!0}},setup(f){return(k,c)=>{const v=e.resolveComponent("el-icon");return f.iconObj.type==="custom"?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(f.iconObj.icon),e.normalizeProps(e.mergeProps({key:0},f.iconObj.attrs)),null,16)):f.iconObj.type==="el"?(e.openBlock(),e.createBlock(v,e.normalizeProps(e.mergeProps({key:1},f.iconObj.attrs)),{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(f.iconObj.icon)))]),_:1},16)):f.iconObj.type==="iconfont"?(e.openBlock(),e.createElementBlock("i",e.mergeProps({key:2,class:["icon iconfont","icon-"+f.iconObj.icon]},f.iconObj.attrs),null,16)):(e.openBlock(),e.createElementBlock("i",e.mergeProps({key:3,class:f.iconObj.type},f.iconObj.attrs),e.toDisplayString(f.iconObj.icon),17))}}},de="",F=["onMousedown"],j={class:"com-item-content"},U={key:0,class:"setting-box-pop"},G=["onClick"],J=["onMousedown"],K=["onMousedown"],Q=["onMousedown"],Z=["onMousedown"],ee=["onMousedown"],te=["onMousedown"],oe=["onMousedown"],ne=["onMousedown"],ie={key:0,class:"com-empty"},le=[{__name:"index",props:{itemMinWidth:{type:Number,default:15,validator(f,k){return f>=15}},itemMinHeight:{type:Number,default:15,validator(f,k){return f>=15}},settingIcon:{type:Object,default:()=>({icon:"设置"})}},setup(f,{expose:k}){const c=f,v=e.ref(0),O=e.ref(0),S=e.ref(null),z=e.ref(0),o=e.ref([{width:100,height:100,x:300,y:300},{width:100,height:100,x:390,y:50,static:!0},{width:100,height:100,x:50,y:210,static:!0},{width:100,height:100,x:210,y:600,static:!0},{width:100,height:100,x:700,y:390,static:!0},{width:100,height:100,x:600,y:290,static:!0}]);let a=null,D=null,$=null;const se=(s,n)=>{N(),a=n,o.value[a].move=!0,D=s.clientX-s.target.offsetParent.offsetLeft,$=s.clientY-s.target.offsetParent.offsetTop,window.addEventListener("mousemove",A),window.addEventListener("mouseup",T)},A=s=>{const n=s.clientX-D,l=s.clientY-$,r=n<=w("left")?w("left"):n>=w("right")?w("right"):n,t=l<=w("top")?w("top"):l>=w("bottom")?w("bottom"):l;o.value.filter(g=>g.static===!0).filter(g=>g.x===r&&g.width===o.value[a].width||g.x>r&&g.x<r+o.value[a].width||g.x+g.width>r&&g.x+g.width<r+o.value[a].width).filter(g=>g.y===t&&g.height===o.value[a].height||g.y>t&&g.y<t+o.value[a].height||g.y+g.height>t&&g.y+g.height<t+o.value[a].height).length===0?(o.value[a].x=r,o.value[a].y=t):(o.value.filter(i=>i.static===!0).filter(i=>i.x===r&&i.width===o.value[a].width||i.x>r&&i.x<r+o.value[a].width||i.x+i.width>r&&i.x+i.width<r+o.value[a].width).filter(i=>i.y===o.value[a].y&&i.height===o.value[a].height||i.y>o.value[a].y&&i.y<o.value[a].y+o.value[a].height||i.y+i.height>o.value[a].y&&i.y+i.height<o.value[a].y+o.value[a].height).length===0&&(o.value[a].x=r),o.value.filter(i=>i.static===!0).filter(i=>i.x===o.value[a].x&&i.width===o.value[a].width||i.x>o.value[a].x&&i.x<o.value[a].x+o.value[a].width||i.x+i.width>o.value[a].x&&i.x+i.width<o.value[a].x+o.value[a].width).filter(i=>i.y===t&&i.height===o.value[a].height||i.y>t&&i.y<t+o.value[a].height||i.y+i.height>t&&i.y+i.height<t+o.value[a].height).length===0&&(o.value[a].y=t)),L(),S.value.scrollTo(0,z.value-O.value)},T=()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",T),delete o.value[a].move,a=null},w=s=>{switch(s){case"top":return 0;case"right":return v.value-o.value[a].width;case"bottom":return 999999999;case"left":return 0}};let p=null,C="",V=0,H=0,m=0,y=0,x=0,M=0,E=0,W=0,_=0,P=0;const u=(s,n,l)=>{N(),p=n,C=l,V=s.clientX,H=s.clientY,m=n.width,y=n.height,x=n.y,M=n.x;const r=o.value.filter(h=>h.static===!0&&(h.x<n.x?h.x+h.width>=n.x:h.x<=n.x+n.width)),t=o.value.filter(h=>h.static===!0&&(h.y<n.y?h.y+h.height>=n.y:h.y<=n.y+n.height)),b=r.filter(h=>h.y+h.height<=n.y).map(h=>h.y+h.height);b.length>0?E=Math.max(...b):E=0;const g=r.filter(h=>h.y>=n.y+n.height).map(h=>h.y);g.length>0?W=Math.max(...g):W=0;const X=t.filter(h=>h.x+h.width<=n.x).map(h=>h.x+h.width);X.length>0?_=Math.max(...X):_=0;const i=t.filter(h=>h.x>=n.x+n.width).map(h=>h.x);i.length>0?P=Math.max(...i):P=0,window.addEventListener("mousemove",I),window.addEventListener("mouseup",R)},I=s=>{const n=m+(s.clientX-V),l=y+(s.clientY-H),r=m-(s.clientX-V),t=y-(s.clientY-H),b=x+(s.clientY-H),g=M+(s.clientX-V);switch(C){case"top-left":p.height=t<c.itemMinHeight?c.itemMinHeight:t>d("top")?d("top"):t,p.y=t<c.itemMinHeight?x+y-c.itemMinHeight:t>d("top")?E:b,p.width=r<c.itemMinWidth?c.itemMinWidth:r>d("left")?d("left"):r,p.x=r<c.itemMinWidth?M+m-c.itemMinWidth:r>d("left")?_:g;break;case"top":p.height=t<c.itemMinHeight?c.itemMinHeight:t>d("top")?d("top"):t,p.y=t<c.itemMinHeight?x+y-c.itemMinHeight:t>d("top")?E:b;break;case"top-right":p.height=t<c.itemMinHeight?c.itemMinHeight:t>d("top")?d("top"):t,p.y=t<c.itemMinHeight?x+y-c.itemMinHeight:t>d("top")?E:b,p.width=n<c.itemMinWidth?c.itemMinWidth:n>d("right")?d("right"):n;break;case"left":p.width=r<c.itemMinWidth?c.itemMinWidth:r>d("left")?d("left"):r,p.x=r<c.itemMinWidth?M+m-c.itemMinWidth:r>d("left")?_:g;break;case"right":p.width=n<c.itemMinWidth?c.itemMinWidth:n>d("right")?d("right"):n;break;case"bottom-left":p.height=l<c.itemMinHeight?c.itemMinHeight:l>d("bottom")?d("bottom"):l,p.width=r<c.itemMinWidth?c.itemMinWidth:r>d("left")?d("left"):r,p.x=r<c.itemMinWidth?M+m-c.itemMinWidth:r>d("left")?_:g;break;case"bottom":p.height=l<c.itemMinHeight?c.itemMinHeight:l>d("bottom")?d("bottom"):l;break;case"bottom-right":p.height=l<c.itemMinHeight?c.itemMinHeight:l>d("bottom")?d("bottom"):l,p.width=n<c.itemMinWidth?c.itemMinWidth:n>d("right")?d("right"):n;break}L(),S.value.scrollTo(0,z.value-O.value)},R=s=>{C="",p=null,window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",R)},d=s=>{switch(s){case"top":return x+y-E;case"left":return M+m-_;case"right":return(P>0?P:v.value)-M;case"bottom":return W>0?W-x:999999999}},L=()=>{const s=o.value.map(n=>n.y+n.height);s.length>0?z.value=Math.max(...s)+50:z.value=0},re=(s,n)=>{q(s,n),L()},ce=()=>{},ae=()=>{},q=(s,n)=>{s!==null&&(v.value=s),n!==null&&(O.value=n)},he=s=>{s.showPop||(o.value.forEach(n=>{delete n.showPop}),s.showPop=!0,window.addEventListener("click",N))},N=()=>{o.value.forEach(s=>{delete s.showPop}),window.removeEventListener("click",N)};return e.onBeforeUnmount(()=>{window.removeEventListener("click",N)}),k({init:re,addItem:ce,deleteItem:ae,changePageSize:q}),(s,n)=>(e.openBlock(),e.createElementBlock("div",{class:"vue-drag-component-plus",style:e.normalizeStyle({width:e.unref(v)+"px",height:e.unref(O)+"px"})},[e.createElementVNode("div",{class:"content-box",ref_key:"boxRef",ref:S},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(l,r)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["com-item",l.static===!0||l.dragable===!1?"":"can-drag",l.move?"is-move":""]),style:e.normalizeStyle({width:l.width+"px",height:l.height+"px",top:l.y+"px",left:l.x+"px"}),key:r,onMousedown:e.withModifiers(t=>l.static===!0||l.dragable===!1?null:se(t,r),["prevent"])},[e.createElementVNode("div",j,[e.renderSlot(s.$slots,"item",{$index:r,data:l},()=>[e.createTextVNode(e.toDisplayString(r),1)]),e.createElementVNode("div",{class:"setting-box",style:e.normalizeStyle({display:l.showPop?"flex":"none"}),onMousedown:e.withModifiers(t=>null,["prevent","stop"])},[e.createVNode(B,{iconObj:f.settingIcon,onClick:e.withModifiers(t=>he(l),["prevent","stop"])},null,8,["iconObj","onClick"]),l.showPop?(e.openBlock(),e.createElementBlock("div",U,[e.renderSlot(s.$slots,"setPopNormal",{$index:r,data:l},()=>[e.createElementVNode("div",{class:"setting-box-pop-item",onClick:t=>{e.unref(o).splice(r,1)}},"删除",8,G)])])):e.createCommentVNode("",!0)],36)]),l.static!==!0&&l.resizable!==!1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("div",{class:"resize-line top-left",onMousedown:e.withModifiers(t=>u(t,l,"top-left"),["prevent","stop"])},null,40,J),e.createElementVNode("div",{class:"resize-line top",onMousedown:e.withModifiers(t=>u(t,l,"top"),["prevent","stop"])},null,40,K),e.createElementVNode("div",{class:"resize-line top-right",onMousedown:e.withModifiers(t=>u(t,l,"top-right"),["prevent","stop"])},null,40,Q),e.createElementVNode("div",{class:"resize-line left",onMousedown:e.withModifiers(t=>u(t,l,"left"),["prevent","stop"])},null,40,Z),e.createElementVNode("div",{class:"resize-line right",onMousedown:e.withModifiers(t=>u(t,l,"right"),["prevent","stop"])},null,40,ee),e.createElementVNode("div",{class:"resize-line bottom-left",onMousedown:e.withModifiers(t=>u(t,l,"bottom-left"),["prevent","stop"])},null,40,te),e.createElementVNode("div",{class:"resize-line bottom",onMousedown:e.withModifiers(t=>u(t,l,"bottom"),["prevent","stop"])},null,40,oe),e.createElementVNode("div",{class:"resize-line bottom-right",onMousedown:e.withModifiers(t=>u(t,l,"bottom-right"),["prevent","stop"])},null,40,ne)],64)):e.createCommentVNode("",!0)],46,F))),128)),e.createElementVNode("div",{class:"height-bg",style:e.normalizeStyle({height:e.unref(z)+"px"})},null,4),e.unref(o).length===0?(e.openBlock(),e.createElementBlock("div",ie,[e.renderSlot(s.$slots,"empty",{},()=>[e.createTextVNode(" 暂无数据 ")])])):e.createCommentVNode("",!0)],512)],4))}}],Y={install(f){le.forEach(k=>{f.component("vueDragComponentPlus",k)})}};return typeof window<"u"&&window.Vue&&window.Vue.use(Y),Y});
